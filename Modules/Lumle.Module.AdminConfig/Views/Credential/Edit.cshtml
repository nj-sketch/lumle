@inject Microsoft.AspNetCore.Antiforgery.IAntiforgery antiforgery
@inject IBaseRoleClaimService BaseRoleClaimService
@inject IViewLocalizer Localizer

@model List<CredentialModel>


@{
    var antiforgeryRequestToken = antiforgery.GetAndStoreTokens(Context).RequestToken;
    var hasPermissionForCredentialUpdate = await BaseRoleClaimService.IsClaimExist(new Claim("permission", Permissions.AdminConfigCredentialUpdate), User);
}

@section styles
    {
    <link href="~/assets/widgets/datatable/datatable.min.css" rel="stylesheet" />
    <link href="~/lib/toastr/toastr.css" rel="stylesheet" />
}

@{
    ViewData["Title"] = Localizer[LabelConstants.ManageCredential];
}

<div class="breadcrumb-section clearfix">
    <ol class="breadcrumb">
        <li class="module">@Localizer[LabelConstants.Configuration]</li>
        <li><a href="~/adminconfig/credential">@Localizer[LabelConstants.CredentialCategory]</a></li>
        <li class="active">@Localizer[LabelConstants.Credential]</li>
    </ol>
</div>

<div class="panel">
    <div class="panel-body">
        <div class="dataTable">
            <table cellpadding="0" cellspacing="0" border="0" class="table" id="credentialDataTable" value>
                <thead>
                    <tr>
                        <th>@Localizer[LabelConstants.SN]</th>
                        <th>@Localizer[LabelConstants.Credential]</th>
                        <th>@Localizer[LabelConstants.Value]</th>
                        @if (hasPermissionForCredentialUpdate)
                        {
                            <th></th>
                        }
                        <th style="display:none;"></th>
                    </tr>
                </thead>
                <tbody>
                    @if (Model != null)
                    {
                        for (int i = 0; i < Model.Count; i++)
                        {
                            <tr>
                                <td>@Model[i].Sn</td>
                                <td>@Model[i].DisplayName</td>
                                @if (hasPermissionForCredentialUpdate)
                                {
                                    <td><input value="@Model[i].Value" class="form-control" style="width:100%" /></td>
                                }
                                else
                                {
                                    <td><input value="@Model[i].Value" readonly class="form-control" style="width:100%" /></td>
                                }

                                @if (hasPermissionForCredentialUpdate)
                                {
                                    <td>
                                        <button class="btn btn-primary btn-sm">@Localizer[LabelConstants.Save]</button>
                                        <img style="width: 30px;display:none" src="~/assets/images/spinner/loader-dark.gif" alt="" display="none">
                                    </td>
                                }
                                <td style="display:none;">@Model[i].Id</td>
                            </tr>
                        }
                    }
                </tbody>
            </table>

        </div>
    </div>
</div>

@section scripts
{
    <script type="text/javascript">
        var token = @Json.Serialize(antiforgeryRequestToken);
    </script>
    <script src="~/lib/toastr/toastr.min.js"></script>
    <script src="~/assets/widgets/datatable/datatable.min.js"></script>
    <script src="~/assets/widgets/datatable/datatable-bootstrap.min.js"></script>
    <script src="~/assets/widgets/datatable/datatable-tabletools.min.js"></script>
    <script src="~/adminconfig/js/credential-edit-datatable.js"></script>
}