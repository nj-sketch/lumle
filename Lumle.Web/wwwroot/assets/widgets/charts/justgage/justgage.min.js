function getRandomInt(n,t){return Math.floor(Math.random()*(t-n+1))+n}function cutHex(n){return n.charAt(0)=="#"?n.substring(1,7):n}function getStyle(n,t){var i="";return document.defaultView&&document.defaultView.getComputedStyle?i=document.defaultView.getComputedStyle(n,"").getPropertyValue(t):n.currentStyle&&(t=t.replace(/\-(\w)/g,function(n,t){return t.toUpperCase()}),i=n.currentStyle[t]),i}function onCreateElementNsReady(n){document.createElementNS!=undefined?n():setTimeout(function(){onCreateElementNsReady(n)},100)}var percentColors,getColorForPercentage,ie;JustGage=function(n){var r,u,i,t,h,c;if(!n.id)return alert("Missing id parameter for gauge!"),!1;if(!document.getElementById(n.id))return alert('No element with id: "'+n.id+'" found!'),!1;this.config={id:n.id,title:n.title?n.title:"Title",titleFontColor:n.titleFontColor?n.titleFontColor:"#999999",value:n.value?n.value:0,valueFontColor:n.valueFontColor?n.valueFontColor:"#010101",min:n.min?n.min:0,max:n.max?n.max:100,showMinMax:n.showMinMax!=null?n.showMinMax:!0,gaugeWidthScale:n.gaugeWidthScale?n.gaugeWidthScale:1,gaugeColor:n.gaugeColor?n.gaugeColor:"#edebeb",label:n.label?n.label:"",showInnerShadow:n.showInnerShadow!=null?n.showInnerShadow:!0,shadowOpacity:n.shadowOpacity?n.shadowOpacity:.2,shadowSize:n.shadowSize?n.shadowSize:5,shadowVerticalOffset:n.shadowVerticalOffset?n.shadowVerticalOffset:3,levelColors:n.levelColors?n.levelColors:percentColors,levelColorsGradient:n.levelColorsGradient!=null?n.levelColorsGradient:!0,labelFontColor:n.labelFontColor?n.labelFontColor:"#b3b3b3",startAnimationTime:n.startAnimationTime?n.startAnimationTime:700,startAnimationType:n.startAnimationType?n.startAnimationType:">",refreshAnimationTime:n.refreshAnimationTime?n.refreshAnimationTime:700,refreshAnimationType:n.refreshAnimationType?n.refreshAnimationType:">"};n.value>this.config.max&&(this.config.value=this.config.max);n.value<this.config.min&&(this.config.value=this.config.min);this.originalValue=n.value;this.canvas=Raphael(this.config.id,"100%","100%");r=getStyle(document.getElementById(this.config.id),"width").slice(0,-2)*1;u=getStyle(document.getElementById(this.config.id),"height").slice(0,-2)*1;r/u>1.25?(i=1.25*u,t=u):(i=r,t=r/1.25);var f=(r-i)/2,e=(u-t)/2,l=t/8>10?t/10:10,a=f+i/2,v=e+t/6.5,o=t/6.4>16?t/6.4:16,y=f+i/2,s=e+t/1.4,p=t/16>10?t/16:10,w=f+i/2,b=s+o/2+6,k=t/16>10?t/16:10,d=f+i/10+i/6.666666666666667*this.config.gaugeWidthScale/2,g=e+t/1.126760563380282,nt=t/16>10?t/16:10,tt=f+i-i/10-i/6.666666666666667*this.config.gaugeWidthScale/2,it=e+t/1.126760563380282;this.params={canvasW:r,canvasH:u,widgetW:i,widgetH:t,dx:f,dy:e,titleFontSize:l,titleX:a,titleY:v,valueFontSize:o,valueX:y,valueY:s,labelFontSize:p,labelX:w,labelY:b,minFontSize:k,minX:d,minY:g,maxFontSize:nt,maxX:tt,maxY:it};this.canvas.customAttributes.pki=function(n,t,i,r,u,f,e,o){var a=(1-(n-t)/(i-t))*Math.PI,h=r/2-r/10,c=h-r/6.666666666666667*o,v=r/2+f,l=u/1.25+e,y=r/2+f+h*Math.cos(a),p=u-(u-l)+e-h*Math.sin(a),w=r/2+f+c*Math.cos(a),b=u-(u-l)+e-c*Math.sin(a),s;return s+="M"+(v-c)+","+l+" ",s+="L"+(v-h)+","+l+" ",s+="A"+h+","+h+" 0 0,1 "+y+","+p+" ",s+="L"+w+","+b+" ",s+="A"+c+","+c+" 0 0,0 "+(v-c)+","+l+" ",s+="z ",{path:s}};this.gauge=this.canvas.path().attr({stroke:"none",fill:this.config.gaugeColor,pki:[this.config.max,this.config.min,this.config.max,this.params.widgetW,this.params.widgetH,this.params.dx,this.params.dy,this.config.gaugeWidthScale]});this.gauge.id=this.config.id+"-gauge";this.level=this.canvas.path().attr({stroke:"none",fill:getColorForPercentage((this.config.value-this.config.min)/(this.config.max-this.config.min),this.config.levelColors,this.config.levelColorsGradient),pki:[this.config.min,this.config.min,this.config.max,this.params.widgetW,this.params.widgetH,this.params.dx,this.params.dy,this.config.gaugeWidthScale]});this.level.id=this.config.id+"-level";this.txtTitle=this.canvas.text(this.params.titleX,this.params.titleY,this.config.title);this.txtTitle.attr({"font-size":this.params.titleFontSize,"font-weight":"bold","font-family":"Arial",fill:this.config.titleFontColor,"fill-opacity":"1"});this.txtTitle.id=this.config.id+"-txttitle";this.txtValue=this.canvas.text(this.params.valueX,this.params.valueY,this.originalValue);this.txtValue.attr({"font-size":this.params.valueFontSize,"font-weight":"bold","font-family":"Arial",fill:this.config.valueFontColor,"fill-opacity":"0"});this.txtValue.id=this.config.id+"-txtvalue";this.txtLabel=this.canvas.text(this.params.labelX,this.params.labelY,this.config.label);this.txtLabel.attr({"font-size":this.params.labelFontSize,"font-weight":"normal","font-family":"Arial",fill:this.config.labelFontColor,"fill-opacity":"0"});this.txtLabel.id=this.config.id+"-txtlabel";this.txtMin=this.canvas.text(this.params.minX,this.params.minY,this.config.min);this.txtMin.attr({"font-size":this.params.minFontSize,"font-weight":"normal","font-family":"Arial",fill:this.config.labelFontColor,"fill-opacity":this.config.showMinMax==!0?"1":"0"});this.txtMin.id=this.config.id+"-txtmin";this.txtMax=this.canvas.text(this.params.maxX,this.params.maxY,this.config.max);this.txtMax.attr({"font-size":this.params.maxFontSize,"font-weight":"normal","font-family":"Arial",fill:this.config.labelFontColor,"fill-opacity":this.config.showMinMax==!0?"1":"0"});this.txtMax.id=this.config.id+"-txtmax";h=this.canvas.canvas.childNodes[1];c="http://www.w3.org/2000/svg";ie<9?onCreateElementNsReady(function(){this.generateShadow()}):this.generateShadow(c,h);this.level.animate({pki:[this.config.value,this.config.min,this.config.max,this.params.widgetW,this.params.widgetH,this.params.dx,this.params.dy,this.config.gaugeWidthScale]},this.config.startAnimationTime,this.config.startAnimationType);this.txtValue.animate({"fill-opacity":"1"},this.config.startAnimationTime,this.config.startAnimationType);this.txtLabel.animate({"fill-opacity":"1"},this.config.startAnimationTime,this.config.startAnimationType)};JustGage.prototype.refresh=function(n){originalVal=n;n>this.config.max&&(n=this.config.max);n<this.config.min&&(n=this.config.min);var t=getColorForPercentage((n-this.config.min)/(this.config.max-this.config.min),this.config.levelColors,this.config.levelColorsGradient);this.canvas.getById(this.config.id+"-txtvalue").attr({text:originalVal});this.canvas.getById(this.config.id+"-level").animate({pki:[n,this.config.min,this.config.max,this.params.widgetW,this.params.widgetH,this.params.dx,this.params.dy,this.config.gaugeWidthScale],fill:t},this.config.refreshAnimationTime,this.config.refreshAnimationType)};percentColors=["#a9d70b","#f9c802","#ff0000"];JustGage.prototype.generateShadow=function(n,t){var i=document.createElementNS(n,"filter"),o,s,r,f,u,e;i.setAttribute("id",this.config.id+"-inner-shadow");t.appendChild(i);o=document.createElementNS(n,"feOffset");o.setAttribute("dx",0);o.setAttribute("dy",this.config.shadowVerticalOffset);i.appendChild(o);s=document.createElementNS(n,"feGaussianBlur");s.setAttribute("result","offset-blur");s.setAttribute("stdDeviation",this.config.shadowSize);i.appendChild(s);r=document.createElementNS(n,"feComposite");r.setAttribute("operator","out");r.setAttribute("in","SourceGraphic");r.setAttribute("in2","offset-blur");r.setAttribute("result","inverse");i.appendChild(r);f=document.createElementNS(n,"feFlood");f.setAttribute("flood-color","black");f.setAttribute("flood-opacity",this.config.shadowOpacity);f.setAttribute("result","color");i.appendChild(f);u=document.createElementNS(n,"feComposite");u.setAttribute("operator","in");u.setAttribute("in","color");u.setAttribute("in2","inverse");u.setAttribute("result","shadow");i.appendChild(u);e=document.createElementNS(n,"feComposite");e.setAttribute("operator","over");e.setAttribute("in","shadow");e.setAttribute("in2","SourceGraphic");i.appendChild(e);this.config.showInnerShadow==!0&&(this.canvas.canvas.childNodes[2].setAttribute("filter","url(#"+this.config.id+"-inner-shadow)"),this.canvas.canvas.childNodes[3].setAttribute("filter","url(#"+this.config.id+"-inner-shadow)"))};getColorForPercentage=function(n,t,i){var o=t.length,s,u,r;if(o===1)return t[0];for(s=i?1/(o-1):1/o,u=[],r=0;r<t.length;r++){var v=i?s*r:s*(r+1),y=parseInt(cutHex(t[r]).substring(0,2),16),p=parseInt(cutHex(t[r]).substring(2,4),16),w=parseInt(cutHex(t[r]).substring(4,6),16);u[r]={pct:v,color:{r:y,g:p,b:w}}}if(n==0)return"rgb("+[u[0].color.r,u[0].color.g,u[0].color.b].join(",")+")";for(r=0;r<u.length;r++)if(n<=u[r].pct){if(i==!0){var f=u[r-1],e=u[r],b=e.pct-f.pct,a=(n-f.pct)/b,h=1-a,c=a,l={r:Math.floor(f.color.r*h+e.color.r*c),g:Math.floor(f.color.g*h+e.color.g*c),b:Math.floor(f.color.b*h+e.color.b*c)};return"rgb("+[l.r,l.g,l.b].join(",")+")"}return"rgb("+[u[r].color.r,u[r].color.g,u[r].color.b].join(",")+")"}};ie=function(){for(var i,n=3,t=document.createElement("div"),r=t.getElementsByTagName("i");t.innerHTML="<!--[if gt IE "+ ++n+"]><i><\/i><![endif]-->",r[0];);return n>4?n:i}();