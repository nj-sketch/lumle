/*!
 xCharts v0.3.0 Copyright (c) 2012, tenXer, Inc. All Rights Reserved.
 @license MIT license. http://github.com/tenXer/xcharts for details
 */
(function(){function o(n){return _.chain(_.range(n,10)).reverse().map(function(n){return'g[data-index="'+n+'"]'}).value().join(", ")}function s(n,t){var i=n.getAttribute("class");return(i!==null?i.replace(/color\d+/g,""):"")+" color"+t}function c(n,t){return _.chain(n).pluck("data").flatten().pluck(t).uniq().filter(function(n){return n!==undefined&&n!==null}).value().sort(d3.ascending)}function l(n){var t=n[0],i=n[1],r,u;return t===i&&(u=Math.max(Math.round(t/10),4),t-=u,i+=u),r=i-t,t=t?t-r/10:t,t=n[0]>0?Math.max(t,0):t,i=i?i+r/10:i,i=n[1]<0?Math.min(i,0):i,[t,i]}function a(n,t,i,r){var u,f=_.chain(t).pluck("data").flatten().value();return u={x:d3.extent(f,function(n){return n.x}),y:d3.extent(f,function(n){return n.y})},_.each([i,r],function(t,i){var r=i?"y":"x",e;(u[r]=d3.extent(f,function(n){return n[r]}),t!=="ordinal")&&_.each([r+"Min",r+"Max"],function(i,f){t!=="time"&&(e=l(u[r]));n.hasOwnProperty(i)&&n[i]!==null?u[r][f]=n[i]:t!=="time"&&(u[r][f]=e[f])})}),u}function v(){var n=document;return!!n.createElementNS&&!!n.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect}function i(n,t,i,r){var u=this,f;if(u._options=r=_.defaults(r||{},e),v()===!1)return r.unsupported(i);u._selector=i;u._container=d3.select(i);u._drawSvg();u._mainStorage={};u._compStorage={};t=_.clone(t);n&&!t.type&&(t.type=n);u.setData(t);d3.select(window).on("resize.for."+i,function(){f&&clearTimeout(f);f=setTimeout(function(){f=null;u._resize()},500)})}var i,n={},t={},r={},h,f,u,e;if(function(){var v=this,lt=v._,e={},r=Array.prototype,nt=Object.prototype,at=Function.prototype,y=r.push,t=r.slice,o=r.concat,f=nt.toString,vt=nt.hasOwnProperty,tt=r.forEach,it=r.map,rt=r.reduce,ut=r.reduceRight,ft=r.filter,et=r.every,ot=r.some,s=r.indexOf,st=r.lastIndexOf,yt=Array.isArray,pt=Object.keys,p=at.bind,n=function(t){return t instanceof n?t:this instanceof n?(this._wrapped=t,void 0):new n(t)},i,w,b,h,k,d,c,l,u,ht,ct,a;"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=n),exports._=n):v._=n;n.VERSION="1.4.3";i=n.each=n.forEach=function(t,i,r){var u,o,f;if(null!=t)if(tt&&t.forEach===tt)t.forEach(i,r);else if(t.length===+t.length){for(u=0,o=t.length;o>u;u++)if(i.call(r,t[u],u,t)===e)return}else for(f in t)if(n.has(t,f)&&i.call(r,t[f],f,t)===e)return};n.map=n.collect=function(n,t,r){var u=[];return null==n?u:it&&n.map===it?n.map(t,r):(i(n,function(n,i,f){u[u.length]=t.call(r,n,i,f)}),u)};w="Reduce of empty array with no initial value";n.reduce=n.foldl=n.inject=function(t,r,u,f){var e=arguments.length>2;if(null==t&&(t=[]),rt&&t.reduce===rt)return f&&(r=n.bind(r,f)),e?t.reduce(r,u):t.reduce(r);if(i(t,function(n,t,i){e?u=r.call(f,u,n,t,i):(u=n,e=!0)}),!e)throw new TypeError(w);return u};n.reduceRight=n.foldr=function(t,r,u,f){var o=arguments.length>2,e,s;if(null==t&&(t=[]),ut&&t.reduceRight===ut)return f&&(r=n.bind(r,f)),o?t.reduceRight(r,u):t.reduceRight(r);if(e=t.length,e!==+e&&(s=n.keys(t),e=s.length),i(t,function(n,i,h){i=s?s[--e]:--e;o?u=r.call(f,u,t[i],i,h):(u=t[i],o=!0)}),!o)throw new TypeError(w);return u};n.find=n.detect=function(n,t,i){var r;return b(n,function(n,u,f){if(t.call(i,n,u,f))return(r=n,!0)}),r};n.filter=n.select=function(n,t,r){var u=[];return null==n?u:ft&&n.filter===ft?n.filter(t,r):(i(n,function(n,i,f){t.call(r,n,i,f)&&(u[u.length]=n)}),u)};n.reject=function(t,i,r){return n.filter(t,function(n,t,u){return!i.call(r,n,t,u)},r)};n.every=n.all=function(t,r,u){r||(r=n.identity);var f=!0;return null==t?f:et&&t.every===et?t.every(r,u):(i(t,function(n,t,i){if(!(f=f&&r.call(u,n,t,i)))return e}),!!f)};b=n.some=n.any=function(t,r,u){r||(r=n.identity);var f=!1;return null==t?f:ot&&t.some===ot?t.some(r,u):(i(t,function(n,t,i){if(f||(f=r.call(u,n,t,i)))return e}),!!f)};n.contains=n.include=function(n,t){return null==n?!1:s&&n.indexOf===s?-1!=n.indexOf(t):b(n,function(n){return n===t})};n.invoke=function(i,r){var u=t.call(arguments,2);return n.map(i,function(t){return(n.isFunction(r)?r:t[r]).apply(t,u)})};n.pluck=function(t,i){return n.map(t,function(n){return n[i]})};n.where=function(t,i){return n.isEmpty(i)?[]:n.filter(t,function(n){for(var t in i)if(i[t]!==n[t])return!1;return!0})};n.max=function(t,r,u){if(!r&&n.isArray(t)&&t[0]===+t[0]&&65535>t.length)return Math.max.apply(Math,t);if(!r&&n.isEmpty(t))return-1/0;var f={computed:-1/0,value:-1/0};return i(t,function(n,t,i){var e=r?r.call(u,n,t,i):n;e>=f.computed&&(f={value:n,computed:e})}),f.value};n.min=function(t,r,u){if(!r&&n.isArray(t)&&t[0]===+t[0]&&65535>t.length)return Math.min.apply(Math,t);if(!r&&n.isEmpty(t))return 1/0;var f={computed:1/0,value:1/0};return i(t,function(n,t,i){var e=r?r.call(u,n,t,i):n;f.computed>e&&(f={value:n,computed:e})}),f.value};n.shuffle=function(t){var u,f=0,r=[];return i(t,function(t){u=n.random(f++);r[f-1]=r[u];r[u]=t}),r};h=function(t){return n.isFunction(t)?t:function(n){return n[t]}};n.sortBy=function(t,i,r){var u=h(i);return n.pluck(n.map(t,function(n,t,i){return{value:n,index:t,criteria:u.call(r,n,t,i)}}).sort(function(n,t){var i=n.criteria,r=t.criteria;if(i!==r){if(i>r||void 0===i)return 1;if(r>i||void 0===r)return-1}return n.index<t.index?-1:1}),"value")};k=function(t,r,u,f){var e={},o=h(r||n.identity);return i(t,function(n,i){var r=o.call(u,n,i,t);f(e,r,n)}),e};n.groupBy=function(t,i,r){return k(t,i,r,function(t,i,r){(n.has(t,i)?t[i]:t[i]=[]).push(r)})};n.countBy=function(t,i,r){return k(t,i,r,function(t,i){n.has(t,i)||(t[i]=0);t[i]++})};n.sortedIndex=function(t,i,r,u){var e;r=null==r?n.identity:h(r);for(var s=r.call(u,i),f=0,o=t.length;o>f;)e=f+o>>>1,s>r.call(u,t[e])?f=e+1:o=e;return f};n.toArray=function(i){return i?n.isArray(i)?t.call(i):i.length===+i.length?n.map(i,n.identity):n.values(i):[]};n.size=function(t){return null==t?0:t.length===+t.length?t.length:n.keys(t).length};n.first=n.head=n.take=function(n,i,r){if(null!=n)return null==i||r?n[0]:t.call(n,0,i)};n.initial=function(n,i,r){return t.call(n,0,n.length-(null==i||r?1:i))};n.last=function(n,i,r){if(null!=n)return null==i||r?n[n.length-1]:t.call(n,Math.max(n.length-i,0))};n.rest=n.tail=n.drop=function(n,i,r){return t.call(n,null==i||r?1:i)};n.compact=function(t){return n.filter(t,n.identity)};d=function(t,r,u){return i(t,function(t){n.isArray(t)?r?y.apply(u,t):d(t,r,u):u.push(t)}),u};n.flatten=function(n,t){return d(n,t,[])};n.without=function(i){return n.difference(i,t.call(arguments,1))};n.uniq=n.unique=function(t,r,u,f){n.isFunction(r)&&(f=u,u=r,r=!1);var s=u?n.map(t,u,f):t,o=[],e=[];return i(s,function(i,u){(r?u&&e[e.length-1]===i:n.contains(e,i))||(e.push(i),o.push(t[u]))}),o};n.union=function(){return n.uniq(o.apply(r,arguments))};n.intersection=function(i){var r=t.call(arguments,1);return n.filter(n.uniq(i),function(t){return n.every(r,function(i){return n.indexOf(i,t)>=0})})};n.difference=function(i){var u=o.apply(r,t.call(arguments,1));return n.filter(i,function(t){return!n.contains(u,t)})};n.zip=function(){for(var r=t.call(arguments),u=n.max(n.pluck(r,"length")),f=Array(u),i=0;u>i;i++)f[i]=n.pluck(r,""+i);return f};n.object=function(n,t){if(null==n)return{};for(var r={},i=0,u=n.length;u>i;i++)t?r[n[i]]=t[i]:r[n[i][0]]=n[i][1];return r};n.indexOf=function(t,i,r){if(null==t)return-1;var u=0,f=t.length;if(r){if("number"!=typeof r)return u=n.sortedIndex(t,i),t[u]===i?u:-1;u=0>r?Math.max(0,f+r):r}if(s&&t.indexOf===s)return t.indexOf(i,r);for(;f>u;u++)if(t[u]===i)return u;return-1};n.lastIndexOf=function(n,t,i){var u,r;if(null==n)return-1;if(u=null!=i,st&&n.lastIndexOf===st)return u?n.lastIndexOf(t,i):n.lastIndexOf(t);for(r=u?i:n.length;r--;)if(n[r]===t)return r;return-1};n.range=function(n,t,i){1>=arguments.length&&(t=n||0,n=0);i=arguments[2]||1;for(var r=Math.max(Math.ceil((t-n)/i),0),u=0,f=Array(r);r>u;)f[u++]=n,n+=i;return f};c=function(){};n.bind=function(i,r){var u,f;if(i.bind===p&&p)return p.apply(i,t.call(arguments,1));if(!n.isFunction(i))throw new TypeError;return u=t.call(arguments,2),f=function(){var e,n;return(this instanceof f)?(c.prototype=i.prototype,e=new c,c.prototype=null,n=i.apply(e,u.concat(t.call(arguments))),Object(n)===n?n:e):i.apply(r,u.concat(t.call(arguments)))}};n.bindAll=function(r){var u=t.call(arguments,1);return 0==u.length&&(u=n.functions(r)),i(u,function(t){r[t]=n.bind(r[t],r)}),r};n.memoize=function(t,i){var r={};return i||(i=n.identity),function(){var u=i.apply(this,arguments);return n.has(r,u)?r[u]:r[u]=t.apply(this,arguments)}};n.delay=function(n,i){var r=t.call(arguments,2);return setTimeout(function(){return n.apply(null,r)},i)};n.defer=function(i){return n.delay.apply(n,[i,1].concat(t.call(arguments,1)))};n.throttle=function(n,t){var r,u,i,f,e=0,o=function(){e=new Date;i=null;f=n.apply(r,u)};return function(){var s=new Date,h=t-(s-e);return r=this,u=arguments,0>=h?(clearTimeout(i),i=null,e=s,f=n.apply(r,u)):i||(i=setTimeout(o,h)),f}};n.debounce=function(n,t,i){var r,u;return function(){var f=this,e=arguments,o=function(){r=null;i||(u=n.apply(f,e))},s=i&&!r;return clearTimeout(r),r=setTimeout(o,t),s&&(u=n.apply(f,e)),u}};n.once=function(n){var t,i=!1;return function(){return i?t:(i=!0,t=n.apply(this,arguments),n=null,t)}};n.wrap=function(n,t){return function(){var i=[n];return y.apply(i,arguments),t.apply(this,i)}};n.compose=function(){var n=arguments;return function(){for(var t=arguments,i=n.length-1;i>=0;i--)t=[n[i].apply(this,t)];return t[0]}};n.after=function(n,t){return 0>=n?t():function(){if(1>--n)return t.apply(this,arguments)}};n.keys=pt||function(t){var i,r;if(t!==Object(t))throw new TypeError("Invalid object");i=[];for(r in t)n.has(t,r)&&(i[i.length]=r);return i};n.values=function(t){var i=[];for(var r in t)n.has(t,r)&&i.push(t[r]);return i};n.pairs=function(t){var r=[];for(var i in t)n.has(t,i)&&r.push([i,t[i]]);return r};n.invert=function(t){var r={};for(var i in t)n.has(t,i)&&(r[t[i]]=i);return r};n.functions=n.methods=function(t){var i=[];for(var r in t)n.isFunction(t[r])&&i.push(r);return i.sort()};n.extend=function(n){return i(t.call(arguments,1),function(t){if(t)for(var i in t)n[i]=t[i]}),n};n.pick=function(n){var u={},f=o.apply(r,t.call(arguments,1));return i(f,function(t){t in n&&(u[t]=n[t])}),u};n.omit=function(i){var f={},e=o.apply(r,t.call(arguments,1));for(var u in i)n.contains(e,u)||(f[u]=i[u]);return f};n.defaults=function(n){return i(t.call(arguments,1),function(t){if(t)for(var i in t)null==n[i]&&(n[i]=t[i])}),n};n.clone=function(t){return n.isObject(t)?n.isArray(t)?t.slice():n.extend({},t):t};n.tap=function(n,t){return t(n),n};l=function(t,i,r,u){var a,v,e,o,h,c,s;if(t===i)return 0!==t||1/t==1/i;if(null==t||null==i)return t===i;if(t instanceof n&&(t=t._wrapped),i instanceof n&&(i=i._wrapped),a=f.call(t),a!=f.call(i))return!1;switch(a){case"[object String]":return t==i+"";case"[object Number]":return t!=+t?i!=+i:0==t?1/t==1/i:t==+i;case"[object Date]":case"[object Boolean]":return+t==+i;case"[object RegExp]":return t.source==i.source&&t.global==i.global&&t.multiline==i.multiline&&t.ignoreCase==i.ignoreCase}if("object"!=typeof t||"object"!=typeof i)return!1;for(v=r.length;v--;)if(r[v]==t)return u[v]==i;if(r.push(t),u.push(i),e=0,o=!0,"[object Array]"==a){if(e=t.length,o=e==i.length)for(;e--&&(o=l(t[e],i[e],r,u)););}else{if(h=t.constructor,c=i.constructor,h!==c&&!(n.isFunction(h)&&h instanceof h&&n.isFunction(c)&&c instanceof c))return!1;for(s in t)if(n.has(t,s)&&(e++,!(o=n.has(i,s)&&l(t[s],i[s],r,u))))break;if(o){for(s in i)if(n.has(i,s)&&!e--)break;o=!e}}return r.pop(),u.pop(),o};n.isEqual=function(n,t){return l(n,t,[],[])};n.isEmpty=function(t){if(null==t)return!0;if(n.isArray(t)||n.isString(t))return 0===t.length;for(var i in t)if(n.has(t,i))return!1;return!0};n.isElement=function(n){return!(!n||1!==n.nodeType)};n.isArray=yt||function(n){return"[object Array]"==f.call(n)};n.isObject=function(n){return n===Object(n)};i(["Arguments","Function","String","Number","Date","RegExp"],function(t){n["is"+t]=function(n){return f.call(n)=="[object "+t+"]"}});n.isArguments(arguments)||(n.isArguments=function(t){return!(!t||!n.has(t,"callee"))});n.isFunction=function(n){return"function"==typeof n};n.isFinite=function(n){return isFinite(n)&&!isNaN(parseFloat(n))};n.isNaN=function(t){return n.isNumber(t)&&t!=+t};n.isBoolean=function(n){return n===!0||n===!1||"[object Boolean]"==f.call(n)};n.isNull=function(n){return null===n};n.isUndefined=function(n){return void 0===n};n.has=function(n,t){return vt.call(n,t)};n.noConflict=function(){return v._=lt,this};n.identity=function(n){return n};n.times=function(n,t,i){for(var u=Array(n),r=0;n>r;r++)u[r]=t.call(i,r);return u};n.random=function(n,t){return null==t&&(t=n,n=0),n+(0|Math.random()*(t-n+1))};u={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};u.unescape=n.invert(u.escape);ht={escape:RegExp("["+n.keys(u.escape).join("")+"]","g"),unescape:RegExp("("+n.keys(u.unescape).join("|")+")","g")};n.each(["escape","unescape"],function(t){n[t]=function(n){return null==n?"":(""+n).replace(ht[t],function(n){return u[t][n]})}});n.result=function(t,i){if(null==t)return null;var r=t[i];return n.isFunction(r)?r.call(t):r};n.mixin=function(t){i(n.functions(t),function(i){var r=n[i]=t[i];n.prototype[i]=function(){var t=[this._wrapped];return y.apply(t,arguments),a.call(this,r.apply(n,t))}})};ct=0;n.uniqueId=function(n){var t=""+ ++ct;return n?n+t:t};n.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var g=/(.)^/,wt={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},bt=/\\|'|\r|\n|\t|\u2028|\u2029/g;n.template=function(t,i,r){var f,e;r=n.defaults({},r,n.templateSettings);var h=RegExp([(r.escape||g).source,(r.interpolate||g).source,(r.evaluate||g).source].join("|")+"|$","g"),o=0,u="__p+='";t.replace(h,function(n,i,r,f,e){return u+=t.slice(o,e).replace(bt,function(n){return"\\"+wt[n]}),i&&(u+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'"),r&&(u+="'+\n((__t=("+r+"))==null?'':__t)+\n'"),f&&(u+="';\n"+f+"\n__p+='"),o=e+n.length,n});u+="';\n";r.variable||(u="with(obj||{}){\n"+u+"}\n");u="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+u+"return __p;\n";try{f=Function(r.variable||"obj","_",u)}catch(s){throw s.source=u,s;}return i?f(i,n):(e=function(t){return f.call(this,t,n)},e.source="function("+(r.variable||"obj")+"){\n"+u+"}",e)};n.chain=function(t){return n(t).chain()};a=function(t){return this._chain?n(t).chain():t};n.mixin(n);i(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var i=r[t];n.prototype[t]=function(){var n=this._wrapped;return i.apply(n,arguments),"shift"!=t&&"splice"!=t||0!==n.length||delete n[0],a.call(this,n)}});i(["concat","join","slice"],function(t){var i=r[t];n.prototype[t]=function(){return a.call(this,i.apply(this._wrapped,arguments))}});n.extend(n.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this),r={getInsertionPoint:o,colorClass:s},h=this,f=.25,t.ordinal=function(n,t,i){var r=c(n,t);return d3.scale.ordinal().domain(r).rangeRoundBands(i,f)},t.linear=function(n,t,i,r){return d3.scale.linear().domain(r).nice().rangeRound(i)},t.exponential=function(n,t,i,r){return d3.scale.pow().exponent(.65).domain(r).nice().rangeRound(i)},t.time=function(n,t,i,r){return d3.time.scale().domain(_.map(r,function(n){return new Date(n)})).range(i)},t.xy=function(n,t,r,u){var f=n._options,o=a(f,t,r,u),e={},s=[f.axisPaddingLeft,n._width],h=[n._height,f.axisPaddingTop];return _.each([r,u],function(n,r){var u=r===0?"x":"y",f=r===0?s:h,c=i.getScale(n);e[u]=c(t,u,f,o[u])}),e},function(){function f(n,t,i){n.xScale2=d3.scale.ordinal().domain(d3.range(0,i.length)).rangeRoundBands([0,n.xScale.rangeBand()],.08)}function e(n,f,e,o,s){var h,c,l=n.yZero;h=n._g.selectAll(i+e).data(o,function(n){return n.className});h.enter().insert("g",u).attr("data-index",t).style("opacity",0).attr("class",function(n,t){var i=_.uniq((e+n.className).split(".")).join(" ");return i+" bar "+r.colorClass(this,t)}).attr("transform",function(t,i){return"translate("+n.xScale2(i)+",0)"});c=h.selectAll("rect").data(function(n){return n.data},function(n){return n.x});c.enter().append("rect").attr("width",0).attr("rx",3).attr("ry",3).attr("x",function(t){return n.xScale(t.x)+n.xScale2.rangeBand()/2}).attr("height",function(t){return Math.abs(l-n.yScale(t.y))}).attr("y",function(t){return t.y<0?l:n.yScale(t.y)}).on("mouseover",s.mouseover).on("mouseout",s.mouseout).on("click",s.click);f.barGroups=h;f.bars=c}function o(n,t,i){var u=n.yZero;t.barGroups.attr("class",function(n,t){return r.colorClass(this,t)}).transition().duration(i).style("opacity",1).attr("transform",function(t,i){return"translate("+n.xScale2(i)+",0)"});t.bars.transition().duration(i).attr("width",n.xScale2.rangeBand()).attr("x",function(t){return n.xScale(t.x)}).attr("height",function(t){return Math.abs(u-n.yScale(t.y))}).attr("y",function(t){return t.y<0?u:n.yScale(t.y)})}function s(n,t,i){t.bars.exit().transition().duration(i).attr("width",0).remove();t.barGroups.exit().transition().duration(i).style("opacity",0).remove()}function h(n,t,i){var r=n.xScale2?n.xScale2.rangeBand()/2:0;delete n.xScale2;t.bars.transition().duration(i).attr("width",0).attr("x",function(t){return n.xScale(t.x)+r})}var t=2,i="g.bar",u=r.getInsertionPoint(t);n.bar={postUpdateScale:f,enter:e,update:o,exit:s,destroy:h}}(),function(){function f(n,f,e,o){function w(n){return[n.data]}var v=n._options.interpolation,h=function(t){return!n.xScale2&&!n.xScale.rangeBand?n.xScale(t.x):n.xScale(t.x)+n.xScale.rangeBand()/2},c=function(t){return n.yScale(t.y)},y=d3.svg.line().x(h).interpolate(v),p=d3.svg.area().x(h).y1(n.yZero).interpolate(v),s,l,a;s=n._g.selectAll(i+e).data(o,function(n){return n.className});s.enter().insert("g",u).attr("data-index",t).attr("class",function(n,t){var i=_.uniq((e+n.className).split(".")).join(" ");return i+" line "+r.colorClass(this,t)});l=s.selectAll("path.fill").data(w);l.enter().append("path").attr("class","fill").style("opacity",0).attr("d",p.y0(c));a=s.selectAll("path.line").data(w);a.enter().append("path").attr("class","line").style("opacity",0).attr("d",y.y(c));f.lineContainers=s;f.lineFills=l;f.linePaths=a;f.lineX=h;f.lineY=c;f.lineA=p;f.line=y}function e(n,t,i){t.lineContainers.attr("class",function(n,t){return r.colorClass(this,t)});t.lineFills.transition().duration(i).style("opacity",1).attr("d",t.lineA.y0(t.lineY));t.linePaths.transition().duration(i).style("opacity",1).attr("d",t.line.y(t.lineY))}function o(n,t){t.linePaths.exit().style("opacity",0).remove();t.lineFills.exit().style("opacity",0).remove();t.lineContainers.exit().remove()}function s(n,t,i){t.linePaths.transition().duration(i).style("opacity",0);t.lineFills.transition().duration(i).style("opacity",0)}var t=3,i="g.line",u=r.getInsertionPoint(t);n.line={enter:f,update:e,exit:o,destroy:s}}(),function(){function i(n,i,r,u,f){var e;t.enter(n,i,r,u,f);e=i.lineContainers.selectAll("circle").data(function(n){return n.data},function(n){return n.x});e.enter().append("circle").style("opacity",0).attr("cx",i.lineX).attr("cy",i.lineY).attr("r",5).on("mouseover",f.mouseover).on("mouseout",f.mouseout).on("click",f.click);i.lineCircles=e}function r(n,i,r){t.update.apply(null,_.toArray(arguments));i.lineCircles.transition().duration(r).style("opacity",1).attr("cx",i.lineX).attr("cy",i.lineY)}function u(n,i){i.lineCircles.exit().remove();t.exit.apply(null,_.toArray(arguments))}function f(n,i,r){(t.destroy.apply(null,_.toArray(arguments)),i.lineCircles)&&i.lineCircles.transition().duration(r).style("opacity",0)}var t=n.line;n["line-dotted"]={enter:i,update:r,exit:u,destroy:f}}(),function(){function u(n,i,r,u,f){t.enter(n,i,r,u,f)}function i(n){function t(n,t){return n+t.y}return _.map(n,function(n){var i=n.data.length,r=_.clone(n.data);for(n=_.clone(n);i;)i-=1,r[i]=_.clone(n.data[i]),r[i].y0=n.data[i].y,r[i].y=_.reduce(_.first(n.data,i),t,n.data[i].y);return _.extend(n,{data:r})})}function r(n){n.hasOwnProperty("cumulativeOMainData")&&(n._mainData=n.cumulativeOMainData,delete n.cumulativeOMainData,n._compData=n.cumulativeOCompData,delete n.cumulativeOCompData)}function f(n){r(n);n.cumulativeOMainData=n._mainData;n._mainData=i(n._mainData);n.cumulativeOCompData=n._compData;n._compData=i(n._compData)}function e(n){r(n);t.destroy.apply(null,_.toArray(arguments))}var t=n["line-dotted"];n.cumulative={preUpdateScale:f,enter:u,update:t.update,exit:t.exit,destroy:e}}(),u=[[]],e={mouseover:function(){},mouseout:function(){},click:function(){},axisPaddingTop:0,axisPaddingRight:0,axisPaddingBottom:5,axisPaddingLeft:20,paddingTop:0,paddingRight:0,paddingBottom:20,paddingLeft:60,tickHintX:10,tickFormatX:function(n){return n},tickHintY:10,tickFormatY:function(n){return n},xMin:null,xMax:null,yMin:null,yMax:null,dataFormatX:function(n){return n},dataFormatY:function(n){return n},unsupported:function(n){d3.select(n).text("SVG is not supported on your browser")},empty:function(){},notempty:function(){},timing:750,interpolation:"monotone",sortX:function(n,t){return!n.x&&!t.x?0:n.x<t.x?-1:1}},i.setVis=function(t,i){if(n.hasOwnProperty(t))throw'Cannot override vis type "'+t+'".';n[t]=i},i.getVis=function(t){if(!n.hasOwnProperty(t))throw'Vis type "'+t+'" does not exist.';return _.clone(n[t])},i.setScale=function(n,i){if(t.hasOwnProperty(n))throw'Scale type "'+n+'" already exists.';t[n]=i},i.getScale=function(n){if(!t.hasOwnProperty(n))throw'Scale type "'+n+'" does not exist.';return t[n]},i.visutils=r,_.defaults(i.prototype,{setType:function(t,i){var r=this;if(!r._type||t!==r._type){if(!n.hasOwnProperty(t))throw'Vis type "'+t+'" is not defined.';r._type&&r._destroy(r._vis,r._mainStorage);r._type=t;r._vis=n[t];i||r._draw()}},setData:function(n){function u(n){var t=_.map(_.clone(n.data),function(n){var t=_.clone(n);return n.hasOwnProperty("x")&&(t.x=i.dataFormatX(n.x)),n.hasOwnProperty("y")&&(t.y=i.dataFormatY(n.y)),t}).sort(i.sortX);return _.extend(_.clone(n),{data:t})}var t=this,i=t._options,r=_.clone(n);if(!n.hasOwnProperty("main"))throw'No "main" key found in given chart data.';switch(n.type){case"bar":n.xScale="ordinal";break;case undefined:n.type=t._type}i.xMin=isNaN(parseInt(n.xMin,10))?i.xMin:n.xMin;i.xMax=isNaN(parseInt(n.xMax,10))?i.xMax:n.xMax;i.yMin=isNaN(parseInt(n.yMin,10))?i.yMin:n.yMin;i.yMax=isNaN(parseInt(n.yMax,10))?i.yMax:n.yMax;t._vis&&t._destroy(t._vis,t._mainStorage);t.setType(n.type,!0);r.main=_.map(r.main,u);t._mainData=r.main;t._xScaleType=r.xScale;t._yScaleType=r.yScale;r.hasOwnProperty("comp")?(r.comp=_.map(r.comp,u),t._compData=r.comp):t._compData=[];t._draw()},setScale:function(n,t){var i=this;switch(n){case"x":i._xScaleType=t;break;case"y":i._yScaleType=t;break;default:throw'Cannot change scale of unknown axis "'+n+'".';}i._draw()},_drawSvg:function(){var t=this,f=t._container,n=t._options,e=parseInt(f.style("width").replace("px",""),10),o=parseInt(f.style("height").replace("px",""),10),i,r,s;i=f.selectAll("svg").data(u);i.enter().append("svg").attr("height",o).attr("width",e).attr("class","xchart");i.transition().attr("width",e).attr("height",o);r=i.selectAll("g").data(u);r.enter().append("g").attr("transform","translate("+n.paddingLeft+","+n.paddingTop+")");s=r.selectAll("g.scale").data(u);s.enter().append("g").attr("class","scale");t._svg=i;t._g=r;t._gScale=s;t._height=o-n.paddingTop-n.paddingBottom-n.axisPaddingTop-n.axisPaddingBottom;t._width=e-n.paddingLeft-n.paddingRight-n.axisPaddingLeft-n.axisPaddingRight},_resize:function(){var n=this;n._drawSvg();n._draw()},_drawAxes:function(){if(!this._noData){var n=this,t=n._options,l=n._gScale.transition().duration(t.timing),o=t.tickHintX,a=t.tickHintY,v=n._height+t.axisPaddingTop+t.axisPaddingBottom,y=d3.svg.line().x(function(n){return n}),r,f,e,s,h,c,i;s=d3.svg.axis().scale(n.xScale).ticks(o).tickSize(-n._height).tickFormat(t.tickFormatX).orient("bottom");e=n._gScale.selectAll("g.axisX").data(u);e.enter().append("g").attr("class","axis axisX").attr("transform","translate(0,"+v+")");e.call(s);i=n._gScale.selectAll(".axisX g")[0];i.length>n._width/80&&(i.sort(function(n,t){var i=/translate\(([^,)]+)/;return n=n.getAttribute("transform").match(i),t=t.getAttribute("transform").match(i),parseFloat(n[1],10)-parseFloat(t[1],10)}),d3.selectAll(i).filter(function(n,t){return t%(Math.ceil(i.length/o)+1)}).remove());c=d3.svg.axis().scale(n.yScale).ticks(a).tickSize(-n._width-t.axisPaddingRight-t.axisPaddingLeft).tickFormat(t.tickFormatY).orient("left");h=n._gScale.selectAll("g.axisY").data(u);h.enter().append("g").attr("class","axis axisY").attr("transform","translate(0,0)");l.selectAll("g.axisY").call(c);r=n._gScale.selectAll("g.axisZero").data([[]]);r.enter().append("g").attr("class","axisZero");f=r.selectAll("line").data([[]]);f.enter().append("line").attr("x1",0).attr("x2",n._width+t.axisPaddingLeft+t.axisPaddingRight).attr("y1",n.yZero).attr("y2",n.yZero);f.transition().duration(t.timing).attr("y1",n.yZero).attr("y2",n.yZero)}},_updateScale:function(){var n=this,e=function(){return _.union(n._mainData,n._compData)},i=e(),r=n._vis,u,f;delete n.xScale;delete n.yScale;delete n.yZero;r.hasOwnProperty("preUpdateScale")&&r.preUpdateScale(n,i,n._mainData,n._compData);i=e();u=t.xy(n,i,n._xScaleType,n._yScaleType);n.xScale=u.x;n.yScale=u.y;f=n.yScale.domain()[0];n.yZero=f>0?n.yScale(f):n.yScale(0);r.hasOwnProperty("postUpdateScale")&&r.postUpdateScale(n,i,n._mainData,n._compData)},_enter:function(n,t,i,r){var u=this,f={click:u._options.click,mouseover:u._options.mouseover,mouseout:u._options.mouseout};u._checkVisMethod(n,"enter");n.enter(u,t,r,i,f)},_update:function(n,t){var i=this;i._checkVisMethod(n,"update");n.update(i,t,i._options.timing)},_exit:function(n,t){var i=this;i._checkVisMethod(n,"exit");n.exit(i,t,i._options.timing)},_destroy:function(n,t){var i=this;i._checkVisMethod(n,"destroy");try{n.destroy(i,t,i._options.timing)}catch(r){}},_draw:function(){var t=this,r=t._options,i,u;t._noData=_.flatten(_.pluck(t._mainData,"data").concat(_.pluck(t._compData,"data"))).length===0;t._updateScale();t._drawAxes();t._enter(t._vis,t._mainStorage,t._mainData,".main");t._exit(t._vis,t._mainStorage);t._update(t._vis,t._mainStorage);i=_.chain(t._compData).groupBy(function(n){return n.type});u=i.keys();_.each(t._compStorage,function(i,r){if(-1===u.indexOf(r).value()){var f=n[r];t._enter(f,i,[],".comp."+r.replace(/\W+/g,""));t._exit(f,i)}});i.each(function(i,r){var f=n[r],u;t._compStorage.hasOwnProperty(r)||(t._compStorage[r]={});u=t._compStorage[r];t._enter(f,u,i,".comp."+r.replace(/\W+/g,""));t._exit(f,u);t._update(f,u)});t._noData?r.empty(t,t._selector,t._mainData):r.notempty(t,t._selector)},_checkVisMethod:function(n,t){var i=this;if(!n[t])throw'Required method "'+t+'" not found on vis type "'+i._type+'".';}}),typeof define=="function"&&define.amd&&typeof define.amd=="object"){define(function(){return i});return}window.xChart=i})();