(function(n){typeof define=="function"&&define.amd?define(["jquery"],n):n(window.jQuery)})(function(n){var v,y,e,h;"function"!=typeof Array.prototype.reduce&&(Array.prototype.reduce=function(n,t){var i,r,f=this.length>>>0,u=!1;for(1<arguments.length&&(r=t,u=!0),i=0;f>i;++i)this.hasOwnProperty(i)&&(u?r=n(r,this[i],i,this):(r=this[i],u=!0));if(!u)throw new TypeError("Reduce of empty array with no initial value");return r});var c=typeof define=="function"&&define.amd,p=function(t){var r=t==="Comic Sans MS"?"Courier New":"Comic Sans MS",i=n("<div>").css({position:"absolute",left:"-9999px",top:"-9999px",fontSize:"200px"}).text("mmmmmmmmmwwwwwww").appendTo(document.body),u=i.css("fontFamily",r).width(),f=i.css("fontFamily",t+","+r).width();return i.remove(),u!==f},r={isMac:navigator.appVersion.indexOf("Mac")>-1,isMSIE:navigator.userAgent.indexOf("MSIE")>-1||navigator.userAgent.indexOf("Trident")>-1,isFF:navigator.userAgent.indexOf("Firefox")>-1,jqueryVersion:parseFloat(n.fn.jquery),isSupportAmd:c,hasCodeMirror:c?require.specified("CodeMirror"):!!window.CodeMirror,isFontInstalled:p},f=function(){var t=function(n){return function(t){return n===t}},i=function(n,t){return n===t},r=function(){return!0},u=function(){return!1},f=function(n){return function(){return!n.apply(n,arguments)}},e=function(n){return n},o=0,s=function(n){var t=++o+"";return n?n+t:t},h=function(t){var i=n(document);return{top:t.top+i.scrollTop(),left:t.left+i.scrollLeft(),width:t.right-t.left,height:t.bottom-t.top}},c=function(n){var i={};for(var t in n)n.hasOwnProperty(t)&&(i[n[t]]=t);return i};return{eq:t,eq2:i,ok:r,fail:u,not:f,self:e,uniqueId:s,rect2bnd:h,invertObject:c}}(),u=function(){var t=function(n){return n[0]},n=function(n){return n[n.length-1]},r=function(n){return n.slice(0,n.length-1)},i=function(n){return n.slice(1)},u=function(n,t){var i=n.indexOf(t);return i===-1?null:n[i+1]},e=function(n,t){var i=n.indexOf(t);return i===-1?null:n[i-1]},o=function(n,t){return t=t||f.self,n.reduce(function(n,i){return n+t(i)},0)},s=function(n){for(var i=[],t=-1,r=n.length;++t<r;)i[t]=n[t];return i},h=function(r,u){if(!r.length)return[];var f=i(r);return f.reduce(function(t,i){var r=n(t);return u(n(r),i)?r[r.length]=i:t[t.length]=[i],t},[[t(r)]])},c=function(n){for(var i=[],t=0,r=n.length;t<r;t++)n[t]&&i.push(n[t]);return i};return{head:t,last:n,initial:r,tail:i,prev:e,next:u,sum:o,from:s,compact:c,clusterBy:h}}(),t=function(){var s=function(t){return t&&n(t).hasClass("note-editable")},b=function(t){return t&&n(t).hasClass("note-control-sizing")},k=function(t){var i,r;return t.hasClass("note-air-editor")?(r=u.last(t.attr("id").split("-")),i=function(t){return function(){return n(t+r)}},{editor:function(){return t},editable:function(){return t},popover:i("#note-popover-"),handle:i("#note-handle-"),dialog:i("#note-dialog-")}):(i=function(n){return function(){return t.find(n)}},{editor:function(){return t},dropzone:i(".note-dropzone"),toolbar:i(".note-toolbar"),editable:i(".note-editable"),codable:i(".note-codable"),statusbar:i(".note-statusbar"),popover:i(".note-popover"),handle:i(".note-handle"),dialog:i(".note-dialog")})},i=function(n){return function(t){return t&&t.nodeName===n}},d=function(n){return n&&/^DIV|^P|^LI|^H[1-7]/.test(n.nodeName)},g=function(n){return n&&/^UL|^OL/.test(n.nodeName)},nt=function(n){return n&&/^TD|^TH/.test(n.nodeName)},v=function(n,t){while(n){if(t(n))return n;if(s(n))break;n=n.parentNode}return null},e=function(n,t){t=t||f.fail;var i=[];return v(n,function(n){return i.push(n),t(n)}),i},y=function(t,i){for(var u=e(t),r=i;r;r=r.parentNode)if(n.inArray(r,u)>-1)return r;return null},tt=function(n,t){var i=[],r=!1,u=!1;return function f(e){if(e){if(e===n&&(r=!0),r&&!u&&i.push(e),e===t){u=!0;return}for(var o=0,s=e.childNodes.length;o<s;o++)f(e.childNodes[o])}}(y(n,t)),i},it=function(n,t){t=t||f.fail;for(var i=[];n;){if(i.push(n),t(n))break;n=n.previousSibling}return i},h=function(n,t){t=t||f.fail;for(var i=[];n;){if(i.push(n),t(n))break;n=n.nextSibling}return i},rt=function(n,t){var i=[];return t=t||f.ok,function r(u){n!==u&&t(u)&&i.push(u);for(var f=0,e=u.childNodes.length;f<e;f++)r(u.childNodes[f])}(n),i},c=function(n,t){var i=t.nextSibling,r=t.parentNode;return i?r.insertBefore(n,i):r.appendChild(n),n},p=function(t,i){return n.each(i,function(n,i){t.appendChild(i)}),t},l=i("#text"),o=function(n){return l(n)?n.nodeValue.length:n.childNodes.length},ut=function(n){return n.offset===0||n.offset===o(n.node)},a=function(n){for(var t=0;n=n.previousSibling;)t+=1;return t},ft=function(n){return n&&n.childNodes&&n.childNodes.length},et=function(n){var t=n.node,i=n.offset,r;return i===0?s(t)?null:{node:t.parentNode,offset:a(t)}:ft(t)?(r=t.childNodes[i-1],{node:r,offset:o(r)}):{node:t,offset:i-1}},ot=function(t,i){var r=u.initial(e(i,f.eq(t)));return n.map(r,a).reverse()},st=function(n,t){for(var i=n,r=0,u=t.length;r<u;r++)i=i.childNodes[t[r]];return i},w=function(n,t){if(t===0)return n;if(t>=o(n))return n.nextSibling;if(l(n))return n.splitText(t);var i=n.childNodes[t];return n=c(n.cloneNode(!1),n),p(n,h(i))},ht=function(n,t,i){var r=e(t,f.eq(n));return r.length===1?w(t,i):r.reduce(function(n,r){var u=r.cloneNode(!1);return c(u,r),n===t&&(n=w(n,i)),p(u,h(n)),u})},ct=function(n,t){var f,r,i,u;if(n&&n.parentNode){if(n.removeNode)return n.removeNode(t);if(f=n.parentNode,!t){for(r=[],i=0,u=n.childNodes.length;i<u;i++)r.push(n.childNodes[i]);for(i=0,u=r.length;i<u;i++)f.insertBefore(r[i],n)}f.removeChild(n)}},lt=function(n){return t.isTextarea(n[0])?n.val():n.html()};return{blank:r.isMSIE?"&nbsp;":"<br/>",emptyPara:"<p><br/><\/p>",isEditable:s,isControlSizing:b,buildLayoutInfo:k,isText:l,isPara:d,isList:g,isTable:i("TABLE"),isCell:nt,isAnchor:i("A"),isDiv:i("DIV"),isLi:i("LI"),isSpan:i("SPAN"),isB:i("B"),isU:i("U"),isS:i("S"),isI:i("I"),isImg:i("IMG"),isTextarea:i("TEXTAREA"),length:o,isEdgeBP:ut,prevBP:et,ancestor:v,listAncestor:e,listNext:h,listPrev:it,listDescendant:rt,commonAncestor:y,listBetween:tt,insertAfter:c,position:a,makeOffsetPath:ot,fromOffsetPath:st,splitTree:ht,remove:ct,html:lt}}(),w={version:"0.5.3",options:{width:null,height:null,minHeight:null,maxHeight:null,focus:!1,tabsize:4,styleWithSpan:!0,disableLinkTarget:!1,disableDragAndDrop:!1,disableResizeEditor:!1,codemirror:{mode:"text/html",htmlMode:!0,lineNumbers:!0,autoFormatOnStart:!1},lang:"en-US",direction:null,toolbar:[["style",["style"]],["font",["bold","italic","underline","superscript","subscript","strikethrough","clear"]],["fontname",["fontname"]],["color",["color"]],["para",["ul","ol","paragraph"]],["height",["height"]],["table",["table"]],["insert",["link","picture","video","hr"]],["view",["fullscreen","codeview"]],["help",["help"]]],airMode:!1,airPopover:[["color",["color"]],["font",["bold","underline","clear"]],["para",["ul","paragraph"]],["table",["table"]],["insert",["link","picture"]]],styleTags:["p","blockquote","pre","h1","h2","h3","h4","h5","h6"],defaultFontName:"Helvetica Neue",fontNames:["Arial","Arial Black","Comic Sans MS","Courier New","Helvetica Neue","Impact","Lucida Grande","Tahoma","Times New Roman","Verdana"],colors:[["#000000","#424242","#636363","#9C9C94","#CEC6CE","#EFEFEF","#F7F7F7","#FFFFFF"],["#FF0000","#FF9C00","#FFFF00","#00FF00","#00FFFF","#0000FF","#9C00FF","#FF00FF"],["#F7C6CE","#FFE7CE","#FFEFC6","#D6EFD6","#CEDEE7","#CEE7F7","#D6D6E7","#E7D6DE"],["#E79C9C","#FFC69C","#FFE79C","#B5D6A5","#A5C6CE","#9CC6EF","#B5A5D6","#D6A5BD"],["#E76363","#F7AD6B","#FFD663","#94BD7B","#73A5AD","#6BADDE","#8C7BC6","#C67BA5"],["#CE0000","#E79439","#EFC631","#6BA54A","#4A7B8C","#3984C6","#634AA5","#A54A7B"],["#9C0000","#B56308","#BD9400","#397B21","#104A5A","#085294","#311873","#731842"],["#630000","#7B3900","#846300","#295218","#083139","#003163","#21104A","#4A1031"]],fontSizes:["8","9","10","11","12","14","18","24","36"],lineHeights:["1.0","1.2","1.4","1.5","1.6","1.8","2.0","3.0"],insertTableMaxSize:{col:10,row:10},oninit:null,onfocus:null,onblur:null,onenter:null,onkeyup:null,onkeydown:null,onImageUpload:null,onImageUploadError:null,onToolbarClick:null,onCreateLink:function(n){return n.indexOf("@")!==-1&&n.indexOf(":")===-1?n="mailto:"+n:n.indexOf("://")===-1&&(n="http://"+n),n},keyMap:{pc:{"CTRL+Z":"undo","CTRL+Y":"redo",TAB:"tab","SHIFT+TAB":"untab","CTRL+B":"bold","CTRL+I":"italic","CTRL+U":"underline","CTRL+SHIFT+S":"strikethrough","CTRL+BACKSLASH":"removeFormat","CTRL+SHIFT+L":"justifyLeft","CTRL+SHIFT+E":"justifyCenter","CTRL+SHIFT+R":"justifyRight","CTRL+SHIFT+J":"justifyFull","CTRL+SHIFT+NUM7":"insertUnorderedList","CTRL+SHIFT+NUM8":"insertOrderedList","CTRL+LEFTBRACKET":"outdent","CTRL+RIGHTBRACKET":"indent","CTRL+NUM0":"formatPara","CTRL+NUM1":"formatH1","CTRL+NUM2":"formatH2","CTRL+NUM3":"formatH3","CTRL+NUM4":"formatH4","CTRL+NUM5":"formatH5","CTRL+NUM6":"formatH6","CTRL+ENTER":"insertHorizontalRule","CTRL+K":"showLinkDialog"},mac:{"CMD+Z":"undo","CMD+SHIFT+Z":"redo",TAB:"tab","SHIFT+TAB":"untab","CMD+B":"bold","CMD+I":"italic","CMD+U":"underline","CMD+SHIFT+S":"strikethrough","CMD+BACKSLASH":"removeFormat","CMD+SHIFT+L":"justifyLeft","CMD+SHIFT+E":"justifyCenter","CMD+SHIFT+R":"justifyRight","CMD+SHIFT+J":"justifyFull","CMD+SHIFT+NUM7":"insertUnorderedList","CMD+SHIFT+NUM8":"insertOrderedList","CMD+LEFTBRACKET":"outdent","CMD+RIGHTBRACKET":"indent","CMD+NUM0":"formatPara","CMD+NUM1":"formatH1","CMD+NUM2":"formatH2","CMD+NUM3":"formatH3","CMD+NUM4":"formatH4","CMD+NUM5":"formatH5","CMD+NUM6":"formatH6","CMD+ENTER":"insertHorizontalRule","CMD+K":"showLinkDialog"}}},lang:{"en-US":{font:{bold:"Bold",italic:"Italic",underline:"Underline",strikethrough:"Strikethrough",subscript:"Subscript",superscript:"Superscript",clear:"Remove Font Style",height:"Line Height",name:"Font Family",size:"Font Size"},image:{image:"Picture",insert:"Insert Image",resizeFull:"Resize Full",resizeHalf:"Resize Half",resizeQuarter:"Resize Quarter",floatLeft:"Float Left",floatRight:"Float Right",floatNone:"Float None",dragImageHere:"Drag an image here",selectFromFiles:"Select from files",url:"Image URL",remove:"Remove Image"},link:{link:"Link",insert:"Insert Link",unlink:"Unlink",edit:"Edit",textToDisplay:"Text to display",url:"To what URL should this link go?",openInNewWindow:"Open in new window"},video:{video:"Video",videoLink:"Video Link",insert:"Insert Video",url:"Video URL?",providers:"(YouTube, Vimeo, Vine, Instagram, DailyMotion or Youku)"},table:{table:"Table"},hr:{insert:"Insert Horizontal Rule"},style:{style:"Style",normal:"Normal",blockquote:"Quote",pre:"Code",h1:"Header 1",h2:"Header 2",h3:"Header 3",h4:"Header 4",h5:"Header 5",h6:"Header 6"},lists:{unordered:"Unordered list",ordered:"Ordered list"},options:{help:"Help",fullscreen:"Full Screen",codeview:"Code View"},paragraph:{paragraph:"Paragraph",outdent:"Outdent",indent:"Indent",left:"Align left",center:"Align center",right:"Align right",justify:"Justify full"},color:{recent:"Recent Color",more:"More Color",background:"Background Color",foreground:"Foreground Color",transparent:"Transparent",setTransparent:"Set transparent",reset:"Reset",resetToDefault:"Reset to default"},shortcut:{shortcuts:"Keyboard shortcuts",close:"Close",textFormatting:"Text formatting",action:"Action",paragraphFormatting:"Paragraph formatting",documentStyle:"Document Style"},history:{undo:"Undo",redo:"Redo"}}}},l=function(){var t=function(t){return n.Deferred(function(i){n.extend(new FileReader,{onload:function(n){var t=n.target.result;i.resolve(t)},onerror:function(){i.reject(this)}}).readAsDataURL(t)}).promise()},i=function(t){return n.Deferred(function(i){n("<img>").one("load",function(){i.resolve(n(this))}).one("error abort",function(){i.reject(n(this))}).css({display:"none"}).appendTo(document.body).attr("src",t)}).promise()};return{readFileAsDataURL:t,createImage:i}}(),s={isEdit:function(n){return[8,9,13,32].indexOf(n)!==-1},nameFromCode:{"8":"BACKSPACE","9":"TAB","13":"ENTER","32":"SPACE","48":"NUM0","49":"NUM1","50":"NUM2","51":"NUM3","52":"NUM4","53":"NUM5","54":"NUM6","55":"NUM7","56":"NUM8","66":"B","69":"E","73":"I","74":"J","75":"K","76":"L","82":"R","83":"S","85":"U","89":"Y","90":"Z","191":"SLASH","219":"LEFTBRACKET","220":"BACKSLASH","221":"RIGHTBRACKET"}},b=function(){var i=function(t,i){if(r.jqueryVersion<1.9){var u={};return n.each(i,function(n,i){u[i]=t.css(i)}),u}return t.css.call(t,i)};this.stylePara=function(i,r){n.each(i.nodes(t.isPara),function(t,i){n(i).css(r)})};this.current=function(r,u){var c=n(t.isText(r.sc)?r.sc.parentNode:r.sc),f=i(c,["font-family","font-size","text-align","list-style-type","line-height"])||{},o,s,e,h;return f["font-size"]=parseInt(f["font-size"],10),f["font-bold"]=document.queryCommandState("bold")?"bold":"normal",f["font-italic"]=document.queryCommandState("italic")?"italic":"normal",f["font-underline"]=document.queryCommandState("underline")?"underline":"normal",f["font-strikethrough"]=document.queryCommandState("strikeThrough")?"strikethrough":"normal",f["font-superscript"]=document.queryCommandState("superscript")?"superscript":"normal",f["font-subscript"]=document.queryCommandState("subscript")?"subscript":"normal",r.isOnList()?(o=["circle","disc","disc-leading-zero","square"],s=n.inArray(f["list-style-type"],o)>-1,f["list-style"]=s?"unordered":"ordered"):f["list-style"]="none",e=t.ancestor(r.sc,t.isPara),e&&e.style["line-height"]?f["line-height"]=e.style.lineHeight:(h=parseInt(f["line-height"],10)/parseInt(f["font-size"],10),f["line-height"]=h.toFixed(1)),f.image=t.isImg(u)&&u,f.anchor=r.isOnAnchor()&&t.ancestor(r.sc,t.isAnchor),f.aAncestor=t.listAncestor(r.sc,t.isEditable),f.range=r,f}},i=function(){var r=!!document.createRange,e=function(n,i){for(var o=n.parentElement(),a=document.body.createTextRange(),s,h=u.from(o.childNodes),c,r,l,e,v,f=0;f<h.length;f++)if(!t.isText(h[f])){if(a.moveToElementText(h[f]),a.compareEndPoints("StartToStart",n)>=0)break;s=h[f]}if(f!==0&&t.isText(h[f-1])){for(c=document.body.createTextRange(),r=null,c.moveToElementText(s||o),c.collapse(!s),r=s?s.nextSibling:o.firstChild,l=n.duplicate(),l.setEndPoint("StartToStart",c),e=l.text.replace(/[\r\n]/g,"").length;e>r.nodeValue.length&&r.nextSibling;)e-=r.nodeValue.length,r=r.nextSibling;v=r.nodeValue;i&&r.nextSibling&&t.isText(r.nextSibling)&&e===r.nodeValue.length&&(e-=r.nodeValue.length,r=r.nextSibling);o=r;f=e}return{cont:o,offset:f}},o=function(n){var e=function(n,i){var r,o,s,h;if(t.isText(n))s=t.listPrev(n,f.not(t.isText)),h=u.last(s).previousSibling,r=h||n.parentNode,i+=u.sum(u.tail(s),t.length),o=!h;else{if(r=n.childNodes[i]||n,t.isText(r))return e(r,i);i=0;o=!1}return{cont:r,collapseToStart:o,offset:i}},i=document.body.createTextRange(),r=e(n.cont,n.offset);return i.moveToElementText(r.cont),i.collapse(r.collapseToStart),i.moveStart("character",r.offset),i},i=function(e,s,h,c){var l,a;this.sc=e;this.so=s;this.ec=h;this.eo=c;l=function(){var n,t;return r?(n=document.createRange(),n.setStart(e,s),n.setEnd(h,c),n):(t=o({cont:e,offset:s}),t.setEndPoint("EndToEnd",o({cont:h,offset:c})),t)};this.getBPs=function(){return{sc:e,so:s,ec:h,eo:c}};this.getStartBP=function(){return{node:e,offset:s}};this.getEndBP=function(){return{node:h,offset:c}};this.select=function(){var t=l(),n;r?(n=document.getSelection(),n.rangeCount>0&&n.removeAllRanges(),n.addRange(t)):t.select()};this.nodes=function(i){i=i||f.ok;var r=t.listBetween(e,h),o=u.compact(n.map(r,function(n){return t.ancestor(n,i)}));return n.map(u.clusterBy(o,f.eq2),u.head)};this.commonAncestor=function(){return t.commonAncestor(e,h)};this.expand=function(n){var f=t.ancestor(e,n),u=t.ancestor(h,n),r;return!f&&!u?new i(e,s,h,c):(r=this.getBPs(),f&&(r.sc=f,r.so=0),u&&(r.ec=u,r.eo=t.length(u)),new i(r.sc,r.so,r.ec,r.eo))};this.collapse=function(n){return n?new i(e,s,e,s):new i(h,c,h,c)};this.splitText=function(){var r=e===h,n=this.getBPs();return t.isText(h)&&!t.isEdgeBP(this.getEndBP())&&h.splitText(c),t.isText(e)&&!t.isEdgeBP(this.getStartBP())&&(n.sc=e.splitText(s),n.so=0,r&&(n.ec=n.sc,n.eo=c-s)),new i(n.sc,n.so,n.ec,n.eo)};this.deleteContents=function(){if(this.isCollapsed())return this;var u=this.splitText(),r=t.prevBP(u.getStartBP());return n.each(u.nodes(),function(n,i){t.remove(i,!t.isPara(i))}),new i(r.node,r.offset,r.node,r.offset)};a=function(n){return function(){var i=t.ancestor(e,n);return!!i&&i===t.ancestor(h,n)}};this.isOnEditable=a(t.isEditable);this.isOnList=a(t.isList);this.isOnAnchor=a(t.isAnchor);this.isOnCell=a(t.isCell);this.isCollapsed=function(){return e===h&&s===c};this.insertNode=function(t){var u=l(),i;return r?u.insertNode(t):(i="node-insert-node-target",t.id=i,u.pasteHTML(t.outerHTML),t=n("#"+i)[0]),t};this.toString=function(){var n=l();return r?n.toString():n.text};this.bookmark=function(n){return{s:{path:t.makeOffsetPath(n,e),offset:s},e:{path:t.makeOffsetPath(n,h),offset:c}}};this.getClientRects=function(){var n=l();return n.getClientRects()}};return{create:function(n,t,u,f){var s,o,h,c,l,a,v;if(arguments.length)arguments.length===2&&(u=n,f=t);else if(r){if(s=document.getSelection(),s.rangeCount===0)return null;o=s.getRangeAt(0);n=o.startContainer;t=o.startOffset;u=o.endContainer;f=o.endOffset}else h=document.selection.createRange(),c=h.duplicate(),c.collapse(!1),l=h,l.collapse(!0),a=e(l,!0),v=e(c,!1),n=a.cont,t=a.offset,u=v.cont,f=v.offset;return new i(n,t,u,f)},createFromNode:function(n){return this.create(n,0,n,1)},createFromBookmark:function(n,r){var u=t.fromOffsetPath(n,r.s.path),f=r.s.offset,e=t.fromOffsetPath(n,r.e.path),o=r.e.offset;return new i(u,f,e,o)}}}(),k=function(){this.tab=function(n,r){var f=t.ancestor(n.commonAncestor(),t.isCell),o=t.ancestor(f,t.isTable),s=t.listDescendant(o,t.isCell),e=u[r?"prev":"next"](s,f);e&&i.create(e,0).select()};this.createTable=function(i,r){for(var u,h,f,c,e=[],o,s=0;s<i;s++)e.push("<td>"+t.blank+"<\/td>");for(o=e.join(""),u=[],f=0;f<r;f++)u.push("<tr>"+o+"<\/tr>");return h=u.join(""),c='<table class="table table-bordered">'+h+"<\/table>",n(c)[0]}},d=function(){var h=new b,s=new k,f,o,c,a,e;for(this.saveRange=function(n){n.focus();n.data("range",i.create())},this.restoreRange=function(n){var t=n.data("range");t&&(t.select(),n.focus())},this.currentStyle=function(n){var t=i.create();return t?t.isOnEditable()&&h.current(t,n):!1},this.undo=function(n){n.data("NoteHistory").undo(n)},this.redo=function(n){n.data("NoteHistory").redo(n)},f=this.recordUndo=function(n){n.data("NoteHistory").recordUndo(n)},o=["bold","italic","underline","strikethrough","superscript","subscript","justifyLeft","justifyCenter","justifyRight","justifyFull","insertOrderedList","insertUnorderedList","indent","outdent","formatBlock","removeFormat","backColor","foreColor","insertHorizontalRule","fontName"],e=0,c=o.length;e<c;e++)this[o[e]]=function(n){return function(t,i){f(t);document.execCommand(n,!1,i)}}(o[e]);for(a=function(r,u,e){var s,o;f(r);s=new Array(e+1).join("&nbsp;");u.insertNode(n('<span id="noteTab">'+s+"<\/span>")[0]);o=n("#noteTab").removeAttr("id");u=i.create(o[0],1);u.select();t.remove(o[0])},this.tab=function(n,t){var r=i.create();r.isCollapsed()&&r.isOnCell()?s.tab(r):a(n,r,t.tabsize)},this.untab=function(){var n=i.create();n.isCollapsed()&&n.isOnCell()&&s.tab(n,!0)},this.insertImage=function(n,t){l.createImage(t).then(function(t){f(n);t.css({display:"",width:Math.min(n.width(),t.width())});i.create().insertNode(t[0])}).fail(function(){var t=n.data("callbacks");t.onImageUploadError&&t.onImageUploadError()})},this.insertVideo=function(t,r){var a;f(t);var e=r.match(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/),o=r.match(/\/\/instagram.com\/p\/(.[a-zA-Z0-9]*)/),s=r.match(/\/\/vine.co\/v\/(.[a-zA-Z0-9]*)/),h=r.match(/\/\/(player.)?vimeo.com\/([a-z]*\/)*([0-9]{6,11})[?]?.*/),c=r.match(/.+dailymotion.com\/(video|hub)\/([^_]+)[^#]*(#video=([^_&]+))?/),l=r.match(/\/\/v\.youku\.com\/v_show\/id_(\w+)\.html/),u;e&&e[2].length===11?(a=e[2],u=n("<iframe>").attr("src","//www.youtube.com/embed/"+a).attr("width","640").attr("height","360")):o&&o[0].length?u=n("<iframe>").attr("src",o[0]+"/embed/").attr("width","612").attr("height","710").attr("scrolling","no").attr("allowtransparency","true"):s&&s[0].length?u=n("<iframe>").attr("src",s[0]+"/embed/simple").attr("width","600").attr("height","600").attr("class","vine-embed"):h&&h[3].length?u=n("<iframe webkitallowfullscreen mozallowfullscreen allowfullscreen>").attr("src","//player.vimeo.com/video/"+h[3]).attr("width","640").attr("height","360"):c&&c[2].length?u=n("<iframe>").attr("src","//www.dailymotion.com/embed/video/"+c[2]).attr("width","640").attr("height","360"):l&&l[1].length&&(u=n("<iframe webkitallowfullscreen mozallowfullscreen allowfullscreen>").attr("height","498").attr("width","510").attr("src","//player.youku.com/embed/"+l[1]));u&&(u.attr("frameborder",0),i.create().insertNode(u[0]))},this.formatBlock=function(n,t){f(n);t=r.isMSIE?"<"+t+">":t;document.execCommand("FormatBlock",!1,t)},this.formatPara=function(n){this.formatBlock(n,"P")},e=1;e<=6;e++)this["formatH"+e]=function(n){return function(t){this.formatBlock(t,"H"+n)}}(e);this.fontSize=function(n,t){f(n);document.execCommand("fontSize",!1,3);r.isFF?n.find("font[size=3]").removeAttr("size").css("font-size",t+"px"):n.find("span").filter(function(){return this.style.fontSize==="medium"}).css("font-size",t+"px")};this.lineHeight=function(n,t){f(n);h.stylePara(i.create(),{lineHeight:t})};this.unlink=function(n){var r=i.create(),u;r.isOnAnchor()&&(f(n),u=t.ancestor(r.sc,t.isAnchor),r=i.createFromNode(u),r.select(),document.execCommand("unlink"))};this.createLink=function(t,r,u){var o=r.url,h=r.text,c=r.newWindow,e=r.range,s;f(t);u.onCreateLink&&(o=u.onCreateLink(o));e=e.deleteContents();s=e.insertNode(n("<A>"+h+"<\/A>")[0]);n(s).attr({href:o,target:c?"_blank":""});e=i.createFromNode(s);e.select()};this.getLinkInfo=function(r){r.focus();var e=i.create().expand(t.isAnchor),f=n(u.head(e.nodes(t.isAnchor)));return{range:e,text:e.toString(),isNewWindow:f.length?f.attr("target")==="_blank":!0,url:f.length?f.attr("href"):""}};this.getVideoInfo=function(n){var r,u;return n.focus(),r=i.create(),r.isOnAnchor()&&(u=t.ancestor(r.sc,t.isAnchor),r=i.createFromNode(u)),{text:r.toString()}};this.color=function(n,t){var i=JSON.parse(t),r=i.foreColor,u=i.backColor;f(n);r&&document.execCommand("foreColor",!1,r);u&&document.execCommand("backColor",!1,u)};this.insertTable=function(n,t){f(n);var r=t.split("x");i.create().insertNode(s.createTable(r[0],r[1]))};this.floatMe=function(n,t,i){f(n);i.css("float",t)};this.resize=function(n,t,i){f(n);i.css({width:n.width()*t+"px",height:""})};this.resizeTo=function(n,t,i){var u,f,r;i?(f=n.y/n.x,r=t.data("ratio"),u={width:r>f?n.x:n.y/r,height:r>f?n.x*r:n.y}):u={width:n.x,height:n.y};t.css(u)};this.removeMedia=function(n,t,i){f(n);i.detach()}},g=function(){var n=[],t=[],r=function(n){var t=n[0],r=i.create();return{contents:n.html(),bookmark:r.bookmark(t),scrollTop:n.scrollTop()}},u=function(n,t){n.html(t.contents).scrollTop(t.scrollTop);i.createFromBookmark(n[0],t.bookmark).select()};this.undo=function(i){var f=r(i);n.length&&(u(i,n.pop()),t.push(f))};this.redo=function(i){var f=r(i);t.length&&(u(i,t.pop()),n.push(f))};this.recordUndo=function(i){t=[];n.push(r(i))}},a=function(){this.update=function(t,i){var e=function(t,i){t.find(".dropdown-menu li a").each(function(){var t=n(this).data("value")+""==i+"";this.className=t?"checked":""})},r=function(n,i){var r=t.find(n);r.toggleClass("active",i())},o=t.find(".note-fontname"),f,s,h;o.length&&(f=i["font-family"],!f||(f=u.head(f.split(",")),f=f.replace(/\'/g,""),o.find(".note-current-fontname").text(f),e(o,f)));s=t.find(".note-fontsize");s.find(".note-current-fontsize").text(i["font-size"]);e(s,parseFloat(i["font-size"]));h=t.find(".note-height");e(h,parseFloat(i["line-height"]));r('button[data-event="bold"]',function(){return i["font-bold"]==="bold"});r('button[data-event="italic"]',function(){return i["font-italic"]==="italic"});r('button[data-event="underline"]',function(){return i["font-underline"]==="underline"});r('button[data-event="strikethrough"]',function(){return i["font-strikethrough"]==="strikethrough"});r('button[data-event="superscript"]',function(){return i["font-superscript"]==="superscript"});r('button[data-event="subscript"]',function(){return i["font-subscript"]==="subscript"});r('button[data-event="justifyLeft"]',function(){return i["text-align"]==="left"||i["text-align"]==="start"});r('button[data-event="justifyCenter"]',function(){return i["text-align"]==="center"});r('button[data-event="justifyRight"]',function(){return i["text-align"]==="right"});r('button[data-event="justifyFull"]',function(){return i["text-align"]==="justify"});r('button[data-event="insertUnorderedList"]',function(){return i["list-style"]==="unordered"});r('button[data-event="insertOrderedList"]',function(){return i["list-style"]==="ordered"})};this.updateRecentColor=function(t,i,r){var o=n(t).closest(".note-color"),u=o.find(".note-recent-color"),f=JSON.parse(u.attr("data-value")),e;f[i]=r;u.attr("data-value",JSON.stringify(f));e=i==="backColor"?"background-color":"color";u.find("i").css(e,r)}},nt=function(){var n=new a;this.update=function(t,i){n.update(t,i)};this.updateRecentColor=function(t,i,r){n.updateRecentColor(t,i,r)};this.activate=function(n){n.find("button").not('button[data-event="codeview"]').removeClass("disabled")};this.deactivate=function(n){n.find("button").not('button[data-event="codeview"]').addClass("disabled")};this.updateFullscreen=function(n,t){var i=n.find('button[data-event="fullscreen"]');i.toggleClass("active",t)};this.updateCodeview=function(n,t){var i=n.find('button[data-event="codeview"]');i.toggleClass("active",t)}},tt=function(){var i=new a,r=function(t,i){var r=n(t),u=i?r.offset():r.position(),f=r.outerHeight(!0);return{left:u.left,top:u.top+f}},t=function(n,t){n.css({display:"block",left:t.left,top:t.top})},e=20;this.update=function(o,s,h){var l,p,a,v,y,c;i.update(o,s);l=o.find(".note-link-popover");s.anchor?(p=l.find("a"),a=n(s.anchor).attr("href"),p.attr("href",a).html(a),t(l,r(s.anchor,h))):l.hide();v=o.find(".note-image-popover");s.image?t(v,r(s.image,h)):v.hide();y=o.find(".note-air-popover");h&&!s.range.isCollapsed()?(c=f.rect2bnd(u.last(s.range.getClientRects())),t(y,{left:Math.max(c.left+c.width/2-e,0),top:c.top+c.height})):y.hide()};this.updateRecentColor=function(n,t,r){i.updateRecentColor(n,t,r)};this.hide=function(n){n.children().hide()}},it=function(){this.update=function(t,i,r){var e=t.find(".note-control-selection"),s;if(i.image){var u=n(i.image),o=r?u.offset():u.position(),f={w:u.outerWidth(!0),h:u.outerHeight(!0)};e.css({display:"block",left:o.left,top:o.top,width:f.w,height:f.h}).data("target",i.image);s=f.w+"x"+f.h;e.find(".note-control-selection-info").text(s)}else e.hide()};this.hide=function(n){n.children().hide()}},rt=function(){var t=function(n,t){n.toggleClass("disabled",!t);n.attr("disabled",!t)};this.showImageDialog=function(i,r){return n.Deferred(function(n){var u=r.find(".note-image-dialog"),f=r.find(".note-image-input"),i=r.find(".note-image-url"),e=r.find(".note-image-btn");u.one("shown.bs.modal",function(){f.replaceWith(f.clone().on("change",function(){n.resolve(this.files);u.modal("hide")}));e.click(function(t){t.preventDefault();n.resolve(i.val());u.modal("hide")});i.on("keyup paste",function(n){var r;r=n.type==="paste"?n.originalEvent.clipboardData.getData("text"):i.val();t(e,r)}).val("").trigger("focus")}).one("hidden.bs.modal",function(){f.off("change");i.off("keyup paste");e.off("click");n.state()==="pending"&&n.reject()}).modal("show")})};this.showVideoDialog=function(i,r,u){return n.Deferred(function(n){var i=r.find(".note-video-dialog"),f=i.find(".note-video-url"),e=i.find(".note-video-btn");i.one("shown.bs.modal",function(){f.val(u.text).keyup(function(){t(e,f.val())}).trigger("keyup").trigger("focus");e.click(function(t){t.preventDefault();n.resolve(f.val());i.modal("hide")})}).one("hidden.bs.modal",function(){f.off("keyup");e.off("click");n.state()==="pending"&&n.reject()}).modal("show")})};this.showLinkDialog=function(i,r,u){return n.Deferred(function(n){var i=r.find(".note-link-dialog"),f=i.find(".note-link-text"),e=i.find(".note-link-url"),o=i.find(".note-link-btn"),s=i.find("input[type=checkbox]");i.one("shown.bs.modal",function(){f.val(u.text);f.keyup(function(){u.text=f.val()});u.url||(u.url=u.text,t(o,u.text));e.keyup(function(){t(o,e.val());u.text||f.val(e.val())}).val(u.url).trigger("focus").trigger("select");s.prop("checked",u.newWindow);o.one("click",function(t){t.preventDefault();n.resolve({range:u.range,url:e.val(),text:f.val(),newWindow:s.is(":checked")});i.modal("hide")})}).one("hidden.bs.modal",function(){f.off("keyup");e.off("keyup");o.off("click");n.state()==="pending"&&n.reject()}).modal("show")}).promise()};this.showHelpDialog=function(t,i){return n.Deferred(function(n){var t=i.find(".note-help-dialog");t.one("hidden.bs.modal",function(){n.resolve()}).modal("show")}).promise()}},o;r.hasCodeMirror&&(r.isSupportAmd?require(["CodeMirror"],function(n){o=n}):o=window.CodeMirror);v=function(){var a=n(window),e=n(document),b=n("html, body"),i=new d,h=new nt,c=new tt,p=new it,v=new rt,f=function(i){var r=n(i).closest(".note-editor, .note-air-editor, .note-air-layout"),f;return r.length?(f=r.is(".note-editor, .note-air-editor")?r:n("#note-editor-"+u.last(r.attr("id").split("-"))),t.buildLayoutInfo(f)):null},w=function(t,r){i.restoreRange(t);var u=t.data("callbacks");if(u.onImageUpload)u.onImageUpload(r,i,t);else n.each(r,function(n,r){l.readFileAsDataURL(r).then(function(n){i.insertImage(t,n)}).fail(function(){u.onImageUploadError&&u.onImageUploadError()})})},y={showLinkDialog:function(n){var r=n.editor(),u=n.dialog(),t=n.editable(),f=i.getLinkInfo(t),e=r.data("options");i.saveRange(t);v.showLinkDialog(t,u,f).then(function(r){i.restoreRange(t);i.createLink(t,r,e);c.hide(n.popover())}).fail(function(){i.restoreRange(t)})},showImageDialog:function(n){var r=n.dialog(),t=n.editable();i.saveRange(t);v.showImageDialog(t,r).then(function(n){i.restoreRange(t);typeof n=="string"?i.insertImage(t,n):w(t,n)}).fail(function(){i.restoreRange(t)})},showVideoDialog:function(n){var r=n.dialog(),t=n.editable(),u=i.getVideoInfo(t);i.saveRange(t);v.showVideoDialog(t,r,u).then(function(n){i.restoreRange(t);i.insertVideo(t,n)}).fail(function(){i.restoreRange(t)})},showHelpDialog:function(n){var r=n.dialog(),t=n.editable();i.saveRange(t);v.showHelpDialog(t,r).then(function(){i.restoreRange(t)})},fullscreen:function(n){var t=n.editor(),f=n.toolbar(),i=n.editable(),r=n.codable(),o=t.data("options"),e=function(n){t.css("width",n.w);i.css("height",n.h);r.css("height",n.h);r.data("cmeditor")&&r.data("cmeditor").setsize(null,n.h)},u;t.toggleClass("fullscreen");u=t.hasClass("fullscreen");u?(i.data("orgheight",i.css("height")),a.on("resize",function(){e({w:a.width(),h:a.height()-f.outerHeight()})}).trigger("resize"),b.css("overflow","hidden")):(a.off("resize"),e({w:o.width||"",h:i.data("orgheight")}),b.css("overflow","visible"));h.updateFullscreen(f,u)},codeview:function(n){var s=n.editor(),v=n.toolbar(),f=n.editable(),u=n.codable(),y=n.popover(),e=s.data("options"),i,l,a;if(s.toggleClass("codeview"),a=s.hasClass("codeview"),a){if(u.val(f.html()),u.height(f.height()),h.deactivate(v),c.hide(y),u.focus(),r.hasCodeMirror){if(i=o.fromTextArea(u[0],e.codemirror),e.codemirror.tern){l=new o.TernServer(e.codemirror.tern);i.ternServer=l;i.on("cursorActivity",function(n){l.updateArgHints(n)})}i.setSize(null,f.outerHeight());e.codemirror.autoFormatOnStart&&i.autoFormatRange&&i.autoFormatRange({line:0,ch:0},{line:i.lineCount(),ch:i.getTextArea().value.length});u.data("cmEditor",i)}}else r.hasCodeMirror&&(i=u.data("cmEditor"),u.val(i.getValue()),i.toTextArea()),f.html(u.val()||t.emptyPara),f.height(e.height?u.height():"auto"),h.activate(v),f.focus();h.updateCodeview(n.toolbar(),a)}},ot=function(n){t.isImg(n.target)&&n.preventDefault()},k=function(n){setTimeout(function(){var t=f(n.currentTarget||n.target),r=i.currentStyle(n.target),u;r&&(u=t.editor().data("options").airMode,u||h.update(t.toolbar(),r),c.update(t.popover(),r,u),p.update(t.handle(),r,u))},0)},st=function(n){var t=f(n.currentTarget||n.target);c.hide(t.popover());p.hide(t.handle())},ht=function(n){var t=n.originalEvent.clipboardData;if(t&&t.items&&t.items.length){var r=f(n.currentTarget||n.target),i=u.head(t.items),e=i.kind==="file"&&i.type.indexOf("image/")!==-1;e&&w(r.editable(),[i.getAsFile()])}},ct=function(r){if(t.isControlSizing(r.target)){r.preventDefault();r.stopPropagation();var o=f(r.target),h=o.handle(),v=o.popover(),y=o.editable(),w=o.editor(),s=h.find(".note-control-selection").data("target"),u=n(s),l=u.offset(),b=e.scrollTop(),a=w.data("options").airMode;e.on("mousemove",function(n){i.resizeTo({x:n.clientX-l.left,y:n.clientY-(l.top-b)},u,!n.shiftKey);p.update(h,{image:s},a);c.update(v,{image:s},a)}).one("mouseup",function(){e.off("mousemove")});u.data("ratio")||u.data("ratio",u.height()/u.width());i.recordUndo(y)}},ut=function(t){var i=n(t.target).closest("[data-event]");i.length&&t.preventDefault()},ft=function(t){var e=n(t.target).closest("[data-event]"),v,p,s,l,w;if(e.length){var r=e.attr("data-event"),a=e.attr("data-value"),o=f(t.target);t.preventDefault();n.inArray(r,["resize","floatMe","removeMedia"])!==-1&&(p=o.handle().find(".note-control-selection"),v=n(p.data("target")));i[r]?(s=o.editable(),s.trigger("focus"),i[r](s,a,v)):y[r]&&y[r].call(this,o);n.inArray(r,["backColor","foreColor"])!==-1&&(l=o.editor().data("options",l),w=l.airMode?c:h,w.updateRecentColor(u.head(e),r,a));k(t)}},lt=24,at=function(n){n.preventDefault();n.stopPropagation();var i=f(n.target).editable(),r=i.offset().top-e.scrollTop(),u=f(n.currentTarget||n.target),t=u.editor().data("options");e.on("mousemove",function(n){var u=n.clientY-(r+lt);u=t.minHeight>0?Math.max(u,t.minHeight):u;u=t.maxHeight>0?Math.min(u,t.maxHeight):u;i.height(u)}).one("mouseup",function(){e.off("mousemove")})},et=18,vt=function(t,i){var u=n(t.target.parentNode),s=u.next(),h=u.find(".note-dimension-picker-mousecatcher"),c=u.find(".note-dimension-picker-highlighted"),o=u.find(".note-dimension-picker-unhighlighted"),f,e,r;t.offsetX===undefined?(e=n(t.target).offset(),f={x:t.pageX-e.left,y:t.pageY-e.top}):f={x:t.offsetX,y:t.offsetY};r={c:Math.ceil(f.x/et)||1,r:Math.ceil(f.y/et)||1};c.css({width:r.c+"em",height:r.r+"em"});h.attr("data-value",r.c+"x"+r.r);3<r.c&&r.c<i.insertTableMaxSize.col&&o.css({width:r.c+1+"em"});3<r.r&&r.r<i.insertTableMaxSize.row&&o.css({height:r.r+1+"em"});s.html(r.c+" x "+r.r)},yt=function(t){var i=n(),r=t.dropzone,u=t.dropzone.find(".note-dropzone-message");e.on("dragenter",function(n){var f=t.editor.hasClass("codeview");f||i.length||(t.editor.addClass("dragover"),r.width(t.editor.width()),r.height(t.editor.height()),u.text("Drag Image Here"));i=i.add(n.target)}).on("dragleave",function(n){i=i.not(n.target);i.length||t.editor.removeClass("dragover")}).on("drop",function(){i=n();t.editor.removeClass("dragover")});r.on("dragenter",function(){r.addClass("hover");u.text("Drop Image")}).on("dragleave",function(){r.removeClass("hover");u.text("Drag Image Here")});r.on("drop",function(n){var t,i;n.preventDefault();t=n.originalEvent.dataTransfer;t&&t.files&&(i=f(n.currentTarget||n.target),i.editable().focus(),w(i.editable(),t.files))}).on("dragover",!1)};this.bindKeyMap=function(n,t){var u=n.editor,r=n.editable;n=f(r);r.on("keydown",function(f){var o=[],h,e;f.metaKey&&o.push("CMD");f.ctrlKey&&!f.altKey&&o.push("CTRL");f.shiftKey&&o.push("SHIFT");h=s.nameFromCode[f.keyCode];h&&o.push(h);e=t[o.join("+")];e?(f.preventDefault(),i[e]?i[e](r,u.data("options")):y[e]&&y[e].call(this,n)):s.isEdit(f.keyCode)&&i.recordUndo(r)})};this.attach=function(n,t){var u,f,i,e;this.bindKeyMap(n,t.keyMap[r.isMac?"mac":"pc"]);n.editable.on("mousedown",ot);n.editable.on("keyup mouseup",k);n.editable.on("scroll",st);n.editable.on("paste",ht);n.handle.on("mousedown",ct);n.popover.on("click",ft);n.popover.on("mousedown",ut);if(!t.airMode){t.disableDragAndDrop||yt(n);n.toolbar.on("click",ft);n.toolbar.on("mousedown",ut);if(!t.disableResizeEditor)n.statusbar.on("mousedown",at)}u=t.airMode?n.popover:n.toolbar;f=u.find(".note-dimension-picker-mousecatcher");f.css({width:t.insertTableMaxSize.col+"em",height:t.insertTableMaxSize.row+"em"}).on("mousemove",function(n){vt(n,t)});if(n.editor.data("options",t),t.styleWithSpan&&!r.isMSIE&&setTimeout(function(){document.execCommand("styleWithCSS",0,!0)},0),n.editable.data("NoteHistory",new g),t.onenter&&n.editable.keypress(function(n){if(n.keyCode===s.ENTER)t.onenter(n)}),t.onfocus&&n.editable.focus(t.onfocus),t.onblur&&n.editable.blur(t.onblur),t.onkeyup&&n.editable.keyup(t.onkeyup),t.onkeydown&&n.editable.keydown(t.onkeydown),t.onpaste)n.editable.on("paste",t.onpaste);if(t.onToolbarClick&&n.toolbar.click(t.onToolbarClick),t.onChange)if(i=function(){t.onChange(n.editable,n.editable.html())},r.isMSIE){e="DOMCharacterDataModified DOMSubtreeModified DOMNodeInserted";n.editable.on(e,i)}else n.editable.on("input",i);n.editable.data("callbacks",{onAutoSave:t.onAutoSave,onImageUpload:t.onImageUpload,onImageUploadError:t.onImageUploadError,onFileUpload:t.onFileUpload,onFileUploadError:t.onFileUpload})};this.dettach=function(n,t){n.editable.off();n.popover.off();n.handle.off();n.dialog.off();t.airMode||(n.dropzone.off(),n.toolbar.off(),n.statusbar.off())}};y=function(){var u=function(n,t){var r=t.event,u=t.value,f=t.title,e=t.className,i=t.dropdown;return'<button type="button" class="btn btn-default btn-sm btn-small'+(e?" "+e:"")+(i?" dropdown-toggle":"")+'"'+(i?' data-toggle="dropdown"':"")+(f?' title="'+f+'"':"")+(r?' data-event="'+r+'"':"")+(u?" data-value='"+u+"'":"")+' tabindex="-1">'+n+(i?' <span class="caret"><\/span>':"")+"<\/button>"+(i||"")},i=function(n,t){var i='<i class="'+n+'"><\/i>';return u(i,t)},s=function(n,t){return'<div class="'+n+' popover bottom in" style="display: none;"><div class="arrow"><\/div><div class="popover-content">'+t+"<\/div><\/div>"},o=function(n,t,i,r){return'<div class="'+n+' modal" aria-hidden="false"><div class="modal-dialog"><div class="modal-content">'+(t?'<div class="modal-header"><button type="button" class="close" aria-hidden="true" tabindex="-1">&times;<\/button><h4 class="modal-title">'+t+"<\/h4><\/div>":"")+'<form class="note-modal-form"><div class="modal-body"><div class="row-fluid">'+i+"<\/div><\/div>"+(r?'<div class="modal-footer">'+r+"<\/div>":"")+"<\/form><\/div><\/div><\/div>"},h={picture:function(n){return i("glyph-icon icon-picture-o icon-picture",{event:"showImageDialog",title:n.image.image})},link:function(n){return i("glyph-icon icon-link icon-link",{event:"showLinkDialog",title:n.link.link})},video:function(n){return i("glyph-icon icon-youtube-play icon-play",{event:"showVideoDialog",title:n.video.video})},table:function(n){return i("glyph-icon icon-table icon-table",{title:n.table.table,dropdown:'<ul class="dropdown-menu"><div class="note-dimension-picker"><div class="note-dimension-picker-mousecatcher" data-event="insertTable" data-value="1x1"><\/div><div class="note-dimension-picker-highlighted"><\/div><div class="note-dimension-picker-unhighlighted"><\/div><\/div><div class="note-dimension-display"> 1 x 1 <\/div><\/ul>'})},style:function(n,t){var r=t.styleTags.reduce(function(t,i){var r=n.style[i==="p"?"normal":i];return t+'<li><a data-event="formatBlock" href="#" data-value="'+i+'">'+(i==="p"||i==="pre"?r:"<"+i+">"+r+"<\/"+i+">")+"<\/a><\/li>"},"");return i("glyph-icon icon-magic icon-magic",{title:n.style.style,dropdown:'<ul class="dropdown-menu">'+r+"<\/ul>"})},fontname:function(n,t){var i=t.fontNames.reduce(function(n,t){return r.isFontInstalled(t)?n+'<li><a data-event="fontName" href="#" data-value="'+t+'"><i class="glyph-icon icon-check icon-ok"><\/i> '+t+"<\/a><\/li>":n},""),f='<span class="note-current-fontname">'+t.defaultFontName+"<\/span>";return u(f,{title:n.font.name,dropdown:'<ul class="dropdown-menu">'+i+"<\/ul>"})},fontsize:function(n,t){var i=t.fontSizes.reduce(function(n,t){return n+'<li><a data-event="fontSize" href="#" data-value="'+t+'"><i class="glyph-icon icon-check icon-ok"><\/i> '+t+"<\/a><\/li>"},"");return u('<span class="note-current-fontsize">11<\/span>',{title:n.font.size,dropdown:'<ul class="dropdown-menu">'+i+"<\/ul>"})},color:function(n){var t=u('<i class="glyph-icon icon-font icon-font" style="color:black;background-color:yellow;"><\/i>',{className:"note-recent-color",title:n.color.recent,event:"color",value:'{"backColor":"yellow"}'}),i='<ul class="dropdown-menu"><li><div class="btn-group"><div class="note-palette-title">'+n.color.background+'<\/div><div class="note-color-reset" data-event="backColor" data-value="inherit" title="'+n.color.transparent+'">'+n.color.setTransparent+'<\/div><div class="note-color-palette" data-target-event="backColor"><\/div><\/div><div class="btn-group"><div class="note-palette-title">'+n.color.foreground+'<\/div><div class="note-color-reset" data-event="foreColor" data-value="inherit" title="'+n.color.reset+'">'+n.color.resetToDefault+'<\/div><div class="note-color-palette" data-target-event="foreColor"><\/div><\/div><\/li><\/ul>',r=u("",{title:n.color.more,dropdown:i});return t+r},bold:function(n){return i("glyph-icon icon-bold icon-bold",{event:"bold",title:n.font.bold})},italic:function(n){return i("glyph-icon icon-italic icon-italic",{event:"italic",title:n.font.italic})},underline:function(n){return i("glyph-icon icon-underline icon-underline",{event:"underline",title:n.font.underline})},strikethrough:function(n){return i("glyph-icon icon-strikethrough icon-strikethrough",{event:"strikethrough",title:n.font.strikethrough})},superscript:function(n){return i("glyph-icon icon-superscript icon-superscript",{event:"superscript",title:n.font.superscript})},subscript:function(n){return i("glyph-icon icon-subscript icon-subscript",{event:"subscript",title:n.font.subscript})},clear:function(n){return i("glyph-icon icon-eraser icon-eraser",{event:"removeFormat",title:n.font.clear})},ul:function(n){return i("glyph-icon icon-list-ul icon-list-ul",{event:"insertUnorderedList",title:n.lists.unordered})},ol:function(n){return i("glyph-icon icon-list-ol icon-list-ol",{event:"insertOrderedList",title:n.lists.ordered})},paragraph:function(n){var t=i("glyph-icon icon-align-left icon-align-left",{title:n.paragraph.left,event:"justifyLeft"}),r=i("glyph-icon icon-align-center icon-align-center",{title:n.paragraph.center,event:"justifyCenter"}),u=i("glyph-icon icon-align-right icon-align-right",{title:n.paragraph.right,event:"justifyRight"}),f=i("glyph-icon icon-align-justify icon-align-justify",{title:n.paragraph.justify,event:"justifyFull"}),e=i("glyph-icon icon-outdent icon-indent-left",{title:n.paragraph.outdent,event:"outdent"}),o=i("glyph-icon icon-indent icon-indent-right",{title:n.paragraph.indent,event:"indent"}),s='<div class="dropdown-menu"><div class="note-align btn-group">'+t+r+u+f+'<\/div><div class="note-list btn-group">'+o+e+"<\/div><\/div>";return i("glyph-icon icon-align-left icon-align-left",{title:n.paragraph.paragraph,dropdown:s})},height:function(n,t){var r=t.lineHeights.reduce(function(n,t){return n+'<li><a data-event="lineHeight" href="#" data-value="'+parseFloat(t)+'"><i class="glyph-icon icon-check icon-ok"><\/i> '+t+"<\/a><\/li>"},"");return i("glyph-icon icon-text-height icon-text-height",{title:n.font.height,dropdown:'<ul class="dropdown-menu">'+r+"<\/ul>"})},help:function(n){return i("glyph-icon icon-question icon-question",{event:"showHelpDialog",title:n.options.help})},fullscreen:function(n){return i("glyph-icon icon-arrows-alt icon-fullscreen",{event:"fullscreen",title:n.options.fullscreen})},codeview:function(n){return i("glyph-icon icon-code icon-code",{event:"codeview",title:n.options.codeview})},undo:function(n){return i("glyph-icon icon-undo icon-undo",{event:"undo",title:n.history.undo})},redo:function(n){return i("glyph-icon icon-repeat icon-repeat",{event:"redo",title:n.history.redo})},hr:function(n){return i("glyph-icon icon-minus icon-hr",{event:"insertHorizontalRule",title:n.hr.insert})}},a=function(n,t){var r=function(){var t=i("glyph-icon icon-edit icon-edit",{title:n.link.edit,event:"showLinkDialog"}),r=i("glyph-icon icon-unlink icon-unlink",{title:n.link.unlink,event:"unlink"}),u='<a href="http://www.google.com" target="_blank">www.google.com<\/a>&nbsp;&nbsp;<div class="note-insert btn-group">'+t+r+"<\/div>";return s("note-link-popover",u)},f=function(){var t=u('<span class="note-fontsize-10">100%<\/span>',{title:n.image.resizeFull,event:"resize",value:"1"}),r=u('<span class="note-fontsize-10">50%<\/span>',{title:n.image.resizeHalf,event:"resize",value:"0.5"}),f=u('<span class="note-fontsize-10">25%<\/span>',{title:n.image.resizeQuarter,event:"resize",value:"0.25"}),e=i("glyph-icon icon-align-left icon-align-left",{title:n.image.floatLeft,event:"floatMe",value:"left"}),o=i("glyph-icon icon-align-right icon-align-right",{title:n.image.floatRight,event:"floatMe",value:"right"}),h=i("glyph-icon icon-align-justify icon-align-justify",{title:n.image.floatNone,event:"floatMe",value:"none"}),c=i("glyph-icon icon-trash-o icon-trash",{title:n.image.remove,event:"removeMedia",value:"none"}),l='<div class="btn-group">'+t+r+f+'<\/div><div class="btn-group">'+e+o+h+'<\/div><div class="btn-group">'+c+"<\/div>";return s("note-image-popover",l)},e=function(){for(var r,u,e,i="",f=0,o=t.airPopover.length;f<o;f++){for(r=t.airPopover[f],i+='<div class="note-'+r[0]+' btn-group">',u=0,e=r[1].length;u<e;u++)i+=h[r[1][u]](n,t);i+="<\/div>"}return s("note-air-popover",i)};return'<div class="note-popover">'+r()+f()+(t.airMode?e():"")+"<\/div>"},v=function(){return'<div class="note-handle"><div class="note-control-selection"><div class="note-control-selection-bg"><\/div><div class="note-control-holder note-control-nw"><\/div><div class="note-control-holder note-control-ne"><\/div><div class="note-control-holder note-control-sw"><\/div><div class="note-control-sizing note-control-se"><\/div><div class="note-control-selection-info"><\/div><\/div><\/div>'},e=function(n,t){return'<table class="note-shortcut"><thead><tr><th><\/th><th>'+n+"<\/th><\/tr><\/thead><tbody>"+t+"<\/tbody><\/table>"},w=function(n){var t="<tr><td>⌘ + B<\/td><td>"+n.font.bold+"<\/td><\/tr><tr><td>⌘ + I<\/td><td>"+n.font.italic+"<\/td><\/tr><tr><td>⌘ + U<\/td><td>"+n.font.underline+"<\/td><\/tr><tr><td>⌘ + ⇧ + S<\/td><td>"+n.font.strikethrough+"<\/td><\/tr><tr><td>⌘ + \\<\/td><td>"+n.font.clear+"<\/td><\/tr>";return e(n.shortcut.textFormatting,t)},b=function(n){var t="<tr><td>⌘ + Z<\/td><td>"+n.history.undo+"<\/td><\/tr><tr><td>⌘ + ⇧ + Z<\/td><td>"+n.history.redo+"<\/td><\/tr><tr><td>⌘ + ]<\/td><td>"+n.paragraph.indent+"<\/td><\/tr><tr><td>⌘ + [<\/td><td>"+n.paragraph.outdent+"<\/td><\/tr><tr><td>⌘ + ENTER<\/td><td>"+n.hr.insert+"<\/td><\/tr>";return e(n.shortcut.action,t)},k=function(n){var t="<tr><td>⌘ + ⇧ + L<\/td><td>"+n.paragraph.left+"<\/td><\/tr><tr><td>⌘ + ⇧ + E<\/td><td>"+n.paragraph.center+"<\/td><\/tr><tr><td>⌘ + ⇧ + R<\/td><td>"+n.paragraph.right+"<\/td><\/tr><tr><td>⌘ + ⇧ + J<\/td><td>"+n.paragraph.justify+"<\/td><\/tr><tr><td>⌘ + ⇧ + NUM7<\/td><td>"+n.lists.ordered+"<\/td><\/tr><tr><td>⌘ + ⇧ + NUM8<\/td><td>"+n.lists.unordered+"<\/td><\/tr>";return e(n.shortcut.paragraphFormatting,t)},d=function(n){var t="<tr><td>⌘ + NUM0<\/td><td>"+n.style.normal+"<\/td><\/tr><tr><td>⌘ + NUM1<\/td><td>"+n.style.h1+"<\/td><\/tr><tr><td>⌘ + NUM2<\/td><td>"+n.style.h2+"<\/td><\/tr><tr><td>⌘ + NUM3<\/td><td>"+n.style.h3+"<\/td><\/tr><tr><td>⌘ + NUM4<\/td><td>"+n.style.h4+"<\/td><\/tr><tr><td>⌘ + NUM5<\/td><td>"+n.style.h5+"<\/td><\/tr><tr><td>⌘ + NUM6<\/td><td>"+n.style.h6+"<\/td><\/tr>";return e(n.shortcut.documentStyle,t)},g=function(n,t){var i=t.extraKeys,u="";for(var r in i)i.hasOwnProperty(r)&&(u+="<tr><td>"+r+"<\/td><td>"+i[r]+"<\/td><\/tr>");return e(n.shortcut.extraKeys,u)},y=function(n,t){var i='<table class="note-shortcut-layout"><tbody><tr><td>'+b(n,t)+"<\/td><td>"+w(n,t)+"<\/td><\/tr><tr><td>"+d(n,t)+"<\/td><td>"+k(n,t)+"<\/td><\/tr>";return t.extraKeys&&(i+='<tr><td colspan="2">'+g(n,t)+"<\/td><\/tr>"),i+"<\/tbody<\/table>"},nt=function(n){return n.replace(/⌘/g,"Ctrl").replace(/⇧/g,"Shift")},p=function(n,t){var i=function(){var t="<h5>"+n.image.selectFromFiles+'<\/h5><input class="note-image-input" type="file" name="files" accept="image/*" /><h5>'+n.image.url+'<\/h5><input class="note-image-url form-control span12" type="text" />',i='<button href="#" class="btn btn-primary note-image-btn disabled" disabled>'+n.image.insert+"<\/button>";return o("note-image-dialog",n.image.insert,t,i)},u=function(){var i='<div class="form-group"><label>'+n.link.textToDisplay+'<\/label><input class="note-link-text form-control span12" type="text" /><\/div><div class="form-group"><label>'+n.link.url+'<\/label><input class="note-link-url form-control span12" type="text" /><\/div>'+(t.disableLinkTarget?"":'<div class="checkbox"><label><input type="checkbox" checked> '+n.link.openInNewWindow+"<\/label><\/div>"),r='<button href="#" class="btn btn-primary note-link-btn disabled" disabled>'+n.link.insert+"<\/button>";return o("note-link-dialog",n.link.insert,i,r)},f=function(){var t='<div class="form-group"><label>'+n.video.url+'<\/label>&nbsp;<small class="text-muted">'+n.video.providers+'<\/small><input class="note-video-url form-control span12" type="text" /><\/div>',i='<button href="#" class="btn btn-primary note-video-btn disabled" disabled>'+n.video.insert+"<\/button>";return o("note-video-dialog",n.video.insert,t,i)},e=function(){var i='<a class="modal-close pull-right" aria-hidden="true" tabindex="-1">'+n.shortcut.close+'<\/a><div class="title">'+n.shortcut.shortcuts+"<\/div>"+(r.isMac?y(n,t):nt(y(n,t)))+'<p class="text-center"><a href="//hackerwins.github.io/summernote/" target="_blank">Summernote 0.5.3<\/a> · <a href="//github.com/HackerWins/summernote" target="_blank">Project<\/a> · <a href="//github.com/HackerWins/summernote/issues" target="_blank">Issues<\/a><\/p>';return o("note-help-dialog","",i,"")};return'<div class="note-dialog">'+i()+u()+f()+e()+"<\/div>"},tt=function(){return'<div class="note-resizebar"><div class="note-icon-bar"><\/div><div class="note-icon-bar"><\/div><div class="note-icon-bar"><\/div><\/div>'},it=function(n){return r.isMac&&(n=n.replace("CMD","⌘").replace("SHIFT","⇧")),n.replace("BACKSLASH","\\").replace("SLASH","/").replace("LEFTBRACKET","[").replace("RIGHTBRACKET","]")},c=function(t,i,r){var u=f.invertObject(i),e=t.find("button");e.each(function(t,i){var r=n(i),f=u[r.data("event")];f&&r.attr("title",function(n,t){return t+" ("+it(f)+")"})}).tooltip({container:"body",trigger:"hover",placement:r||"top"}).on("click",function(){n(this).tooltip("hide")})},l=function(t,i){var r=i.colors;t.find(".note-color-palette").each(function(){for(var f,e,t,h,i,o=n(this),c=o.attr("data-target-event"),s=[],u=0,l=r.length;u<l;u++){for(f=r[u],e=[],t=0,h=f.length;t<h;t++)i=f[t],e.push(['<button type="button" class="note-color-btn" style="background-color:',i,';" data-event="',c,'" data-value="',i,'" title="',i,'" data-toggle="button" tabindex="-1"><\/button>'].join(""));s.push('<div class="note-color-row">'+e.join("")+"<\/div>")}o.html(s.join(""))})};this.createLayoutByAirMode=function(t,i){var w=i.keyMap[r.isMac?"mac":"pc"],y=n.summernote.lang[i.lang],o=f.uniqueId(),s,u,h,e;t.addClass("note-air-editor note-editable");t.attr({id:"note-editor-"+o,contentEditable:!0});s=document.body;u=n(a(y,i));u.addClass("note-air-layout");u.attr("id","note-popover-"+o);u.appendTo(s);c(u,w);l(u,i);h=n(v());h.addClass("note-air-layout");h.attr("id","note-handle-"+o);h.appendTo(s);e=n(p(y,i));e.addClass("note-air-layout");e.attr("id","note-dialog-"+o);e.find("button.close, a.modal-close").click(function(){n(this).closest(".modal").modal("hide")});e.appendTo(s)};this.createLayoutByFrame=function(i,u){var f=n('<div class="note-editor"><\/div>'),nt,y,w,e,o,it,rt,b,s,ut,k,d,g,ft;for(u.width&&f.width(u.width),u.height>0&&n('<div class="note-statusbar">'+(u.disableResizeEditor?"":tt())+"<\/div>").prependTo(f),nt=!i.is(":disabled"),y=n('<div class="note-editable" contentEditable="'+nt+'"><\/div>').prependTo(f),u.height&&y.height(u.height),u.direction&&y.attr("dir",u.direction),y.html(t.html(i)||t.emptyPara),n('<textarea class="note-codable"><\/textarea>').prependTo(f),w=n.summernote.lang[u.lang],e="",o=0,it=u.toolbar.length;o<it;o++){for(rt=u.toolbar[o][0],b=u.toolbar[o][1],e+='<div class="note-'+rt+' btn-group">',s=0,ut=b.length;s<ut;s++)n.isFunction(h[b[s]])&&(e+=h[b[s]](w,u));e+="<\/div>"}e='<div class="note-toolbar btn-toolbar">'+e+"<\/div>";k=n(e).prependTo(f);d=u.keyMap[r.isMac?"mac":"pc"];l(k,u);c(k,d,"bottom");g=n(a(w,u)).prependTo(f);l(g,u);c(g,d);n(v()).prependTo(f);ft=n(p(w,u)).prependTo(f);ft.find("button.close, a.modal-close").click(function(){n(this).closest(".modal").modal("hide")});n('<div class="note-dropzone"><div class="note-dropzone-message"><\/div><\/div>').prependTo(f);f.insertAfter(i);i.hide()};this.noteEditorFromHolder=function(t){return t.hasClass("note-air-editor")?t:t.next().hasClass("note-editor")?t.next():n()};this.createLayout=function(n,t){this.noteEditorFromHolder(n).length||(t.airMode?this.createLayoutByAirMode(n,t):this.createLayoutByFrame(n,t))};this.layoutInfoFromHolder=function(n){var u=this.noteEditorFromHolder(n),i,r;if(u.length){i=t.buildLayoutInfo(u);for(r in i)i.hasOwnProperty(r)&&(i[r]=i[r].call());return i}};this.removeLayout=function(n,t,i){i.airMode?(n.removeClass("note-air-editor note-editable").removeAttr("id contentEditable"),t.popover.remove(),t.handle.remove(),t.dialog.remove()):(n.html(t.editable.html()),t.editor.remove(),n.show())}};n.summernote=n.summernote||{};n.extend(n.summernote,w);e=new y;h=new v;n.fn.extend({summernote:function(i){if(i=n.extend({},n.summernote.options,i),this.each(function(r,u){var f=n(u),o;e.createLayout(f,i);o=e.layoutInfoFromHolder(f);h.attach(o,i);t.isTextarea(f[0])&&f.closest("form").submit(function(){f.val(f.code())})}),this.first().length&&i.focus){var r=e.layoutInfoFromHolder(this.first());r.editable.focus()}return this.length&&i.oninit&&i.oninit(),this},code:function(i){var f,u,o;return i===undefined?(f=this.first(),!f.length)?void 0:(u=e.layoutInfoFromHolder(f),!!(u&&u.editable))?(o=u.editor.hasClass("codeview"),o&&r.hasCodeMirror&&u.codable.data("cmEditor").save(),o?u.codable.val():u.editable.html()):t.isTextarea(f[0])?f.val():f.html():(this.each(function(t,r){var u=e.layoutInfoFromHolder(n(r));u&&u.editable&&u.editable.html(i)}),this)},destroy:function(){return this.each(function(t,i){var f=n(i),r=e.layoutInfoFromHolder(f),u;r&&r.editable&&(u=r.editor.data("options"),h.dettach(r,u),e.removeLayout(f,r,u))}),this}})});